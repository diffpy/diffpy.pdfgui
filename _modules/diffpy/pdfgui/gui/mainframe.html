<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>diffpy.pdfgui.gui.mainframe &mdash; diffpy.pdfgui 3.1.0rc4 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../_static/documentation_options.js?v=6a5857df"></script>
        <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            diffpy.pdfgui
          </a>
              <div class="version">
                3.1.0rc4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial.html">Tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../release.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/diffpy.pdfgui.html">Package API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">diffpy.pdfgui</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">diffpy.pdfgui.gui.mainframe</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for diffpy.pdfgui.gui.mainframe</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: ISO-8859-1 -*-</span>
<span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># PDFgui            by DANSE Diffraction group</span>
<span class="c1">#                   Simon J. L. Billinge</span>
<span class="c1">#                   (c) 2006 trustees of the Michigan State University.</span>
<span class="c1">#                   All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># File coded by:    Chris Farrow</span>
<span class="c1">#</span>
<span class="c1"># See AUTHORS.txt for a list of people who contributed.</span>
<span class="c1"># See LICENSE.txt for license information.</span>
<span class="c1">#</span>
<span class="c1">##############################################################################</span>

<span class="c1"># generated by wxGlade 0.4 on Thu Feb 23 15:06:06 2006</span>
<span class="sd">&quot;&quot;&quot;This module contains the main window of PDFgui.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os.path</span>

<span class="kn">import</span> <span class="nn">wx</span>
<span class="kn">import</span> <span class="nn">wx.aui</span>
<span class="kn">import</span> <span class="nn">wx.lib.newevent</span>

<span class="kn">from</span> <span class="nn">diffpy.pdfgui.control</span> <span class="kn">import</span> <span class="n">structureviewer</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.control.controlerrors</span> <span class="kn">import</span> <span class="n">ControlError</span><span class="p">,</span> <span class="n">ControlFileError</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.control.pdfguicontrol</span> <span class="kn">import</span> <span class="n">pdfguicontrol</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui</span> <span class="kn">import</span> <span class="n">pdfguiglobals</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.aboutdialog</span> <span class="kn">import</span> <span class="n">DialogAbout</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.adddatapanel</span> <span class="kn">import</span> <span class="n">AddDataPanel</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.addphasepanel</span> <span class="kn">import</span> <span class="n">AddPhasePanel</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.blankpanel</span> <span class="kn">import</span> <span class="n">BlankPanel</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.calculationpanel</span> <span class="kn">import</span> <span class="n">CalculationPanel</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.datasetpanel</span> <span class="kn">import</span> <span class="n">DataSetPanel</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.dopingseriespanel</span> <span class="kn">import</span> <span class="n">DopingSeriesPanel</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.errorreportdialog</span> <span class="kn">import</span> <span class="n">USERSMAILINGLIST</span><span class="p">,</span> <span class="n">ErrorReportDialog</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.errorwrapper</span> <span class="kn">import</span> <span class="n">catchObjectErrors</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.fitnotebookpanel</span> <span class="kn">import</span> <span class="n">FitNotebookPanel</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.fittree</span> <span class="kn">import</span> <span class="n">FitTree</span><span class="p">,</span> <span class="n">FitTreeError</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.journalpanel</span> <span class="kn">import</span> <span class="n">JournalPanel</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.outputpanel</span> <span class="kn">import</span> <span class="n">OutputPanel</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.pdfguiglobals</span> <span class="kn">import</span> <span class="n">docMainFile</span><span class="p">,</span> <span class="n">iconpath</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.phasenotebookpanel</span> <span class="kn">import</span> <span class="n">PhaseNotebookPanel</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.plotpanel</span> <span class="kn">import</span> <span class="n">PlotPanel</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.preferencespanel</span> <span class="kn">import</span> <span class="n">PreferencesPanel</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.rseriespanel</span> <span class="kn">import</span> <span class="n">RSeriesPanel</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.temperatureseriespanel</span> <span class="kn">import</span> <span class="n">TemperatureSeriesPanel</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.welcomepanel</span> <span class="kn">import</span> <span class="n">WelcomePanel</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.wxextensions</span> <span class="kn">import</span> <span class="n">wx12</span>
<span class="kn">from</span> <span class="nn">diffpy.pdfgui.utils</span> <span class="kn">import</span> <span class="n">QuotedConfigParser</span>

<span class="p">(</span><span class="n">PDFCustomEvent</span><span class="p">,</span> <span class="n">EVT_PDFCUSTOM</span><span class="p">)</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">newevent</span><span class="o">.</span><span class="n">NewEvent</span><span class="p">()</span>

<span class="c1"># WARNING - This file cannot be maintained with wxglade any longer. Do not make</span>
<span class="c1"># modifications with wxglade!!!</span>

<span class="c1"># README - Note that wx.TreeCtrl.GetSelections works differently in MSW than it</span>
<span class="c1"># does in GTK. In GTK, it returns a list of nodes as they appear in the tree.</span>
<span class="c1"># In MSW, it returns the list of nodes in some other order.  This can lead to</span>
<span class="c1"># trouble if the order of selected nodes is important to a method.</span>
<span class="c1"># wx.TreeControl does not create an event in windows.  Node deselection does</span>
<span class="c1"># not create an event on windows. There is no workaround for this.  Node</span>
<span class="c1"># selection vetoing does not work on windows.  Finally, changing the tree</span>
<span class="c1"># selection sends two selection events on windows. One for an empty selection</span>
<span class="c1"># and one with the new selections.</span>


<div class="viewcode-block" id="MainFrame">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame">[docs]</a>
<span class="k">class</span> <span class="nc">MainFrame</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The left pane is a FitTree (from fittree.py), the right is a dynamic</span>
<span class="sd">    panel, accessed via the data member rightPanel, which can hold one of any</span>
<span class="sd">    number of panels. The panels that can appear in the right pane must be</span>
<span class="sd">    derived from PDFPanel (in pdfpanel.py) and are defined in the dynamicPanels</span>
<span class="sd">    dictionary, which is defined in __customProperties. A panel is placed in the</span>
<span class="sd">    right pane by passing its dynamicPanels dictionary key to the</span>
<span class="sd">    switchRightPanel method.  This method takes care of displaying the panel,</span>
<span class="sd">    giving the data it needs, and calling its refresh() method.</span>

<span class="sd">    ** NODE TYPES **</span>
<span class="sd">    The FitTree is essential to the functionality of the Gui.</span>
<span class="sd">    The tree contains one of five types of items:</span>
<span class="sd">    &quot;fit&quot;           --  This represents a fit that is to be run by pdffit.</span>
<span class="sd">    &quot;dataset&quot;       --  This represents a data for a fit.</span>
<span class="sd">    &quot;phase&quot;         --  This represents the theoretical phases needed for a</span>
<span class="sd">                        dataset or a calculation.</span>
<span class="sd">    &quot;calculation&quot;   --  This represents a calculation which is to be made from</span>
<span class="sd">                        using a configured fit.</span>

<span class="sd">    Depending upon what type of item is selected in the tree, the right pane</span>
<span class="sd">    will display the properties and configuration of that item (if in &quot;fitting</span>
<span class="sd">    mode&quot;, see below.) More on these item types is given in the documentation</span>
<span class="sd">    for the FitTree in fittree.py. See r</span>

<span class="sd">    ** MODES **</span>
<span class="sd">    The program has various modes of operation.</span>
<span class="sd">    &quot;fitting&quot;       --  In this mode the right pane changes depending upon what</span>
<span class="sd">                        type of item is selected in the FitTree. When the</span>
<span class="sd">                        fitting button is pressed, the program is in &quot;fitting&quot;</span>
<span class="sd">                        mode.</span>
<span class="sd">    &quot;addingdata&quot;    --  This mode is for adding data.</span>
<span class="sd">    &quot;addingphase&quot;   --  This mode is for adding the phase</span>
<span class="sd">    &quot;config&quot;        --  This mode is used for preferences and structure viewer</span>
<span class="sd">                        configuration.</span>
<span class="sd">    &quot;rseries&quot;       --  The mode used when configuring an r-series macro.</span>
<span class="sd">    &quot;tseries&quot;       --  The mode used when configuring a temperature series</span>
<span class="sd">                        macro.</span>
<span class="sd">    &quot;dseries&quot;       --  The mode used when configuring a doping series macro.</span>

<span class="sd">    The mode determines how the tree and other widgets react to user</span>
<span class="sd">    interaction. The mode of the program is changed with the method setMode.</span>
<span class="sd">    This method outright enables or disables certain widgets that should not be</span>
<span class="sd">    used when in certain modes.</span>

<span class="sd">    ** DATA MEMBERS **</span>
<span class="sd">    dynamicPanels -- The dictionary of right panels. This is used to change the</span>
<span class="sd">                     right panel in the method switchRightPanel. The panels held</span>
<span class="sd">                     by the dynamicPanels dictionary are listed below by their</span>
<span class="sd">                     dictionary keys:</span>

<span class="sd">                    * Miscellaneous panels:</span>
<span class="sd">                    &quot;blank&quot;         --  A blank panel</span>
<span class="sd">                    &quot;rseries&quot;       --  The r-series macro panel</span>
<span class="sd">                    &quot;tseries&quot;       --  The temperature series macro panel</span>
<span class="sd">                    &quot;dseries&quot;       --  The doping series macro panel</span>
<span class="sd">                    &quot;welcome&quot;       --  A welcome panel</span>

<span class="sd">                    * &#39;fitting&#39; mode panels</span>
<span class="sd">                    &quot;fit&quot;           --  The panel for &#39;fit&#39; nodes</span>
<span class="sd">                    &quot;phase&quot;         --  The panel for &#39;phase&#39; nodes</span>
<span class="sd">                    &quot;dataset&quot;       --  The panel for &#39;dataset&#39; nodes</span>
<span class="sd">                    &quot;calculation&quot;   --  The panel for &#39;calculation&#39; nodes</span>

<span class="sd">                    * Panels specific to other program modes</span>
<span class="sd">                    &quot;adddata&quot;       --  The panel used in &#39;addingdata&#39; mode</span>
<span class="sd">                    &quot;addphase&quot;      --  The panel used in &#39;addingphase&#39; mode</span>

<span class="sd">                    * Panels for future implementation</span>
<span class="sd">                    &quot;configuration&quot; --  Another &#39;config&#39; mode panel</span>

<span class="sd">    rightPanel  --  The current right panel.</span>
<span class="sd">    fullpath    --  The full path to the most recently accessed project file.</span>
<span class="sd">    workpath    --  The full path to the working directory. This is modified</span>
<span class="sd">                    whenever something is loaded or saved to file. It is</span>
<span class="sd">                    preserved in the current session and across new projects.</span>
<span class="sd">    cP          --  A python SafeConfigurationParser object. This is in charge</span>
<span class="sd">                    of storing configuration information about the most recently</span>
<span class="sd">                    used files list. It is also used by addphasepanel and</span>
<span class="sd">                    adddatapanel to store their respective fullpath variables.</span>
<span class="sd">                    The code that handles the MRU files interacts directly</span>
<span class="sd">                    with cP.</span>
<span class="sd">    mode        --  The current mode of the program. This is modified using the</span>
<span class="sd">                    setMode method. See the MODES section above.</span>
<span class="sd">    name        --  The name of the program as defined in pdfguiglobals.</span>
<span class="sd">    control     --  The pdfguicontrol object needed for interfacing with the</span>
<span class="sd">                    engine pdffit2 code.</span>
<span class="sd">    isAltered   --  A Boolean flag that indicates when the program has been</span>
<span class="sd">                    altered. This should be changed with the method needsSave so</span>
<span class="sd">                    that the save menu item and toolbar button can be updated</span>
<span class="sd">                    accordingly.</span>
<span class="sd">    runningDict --  A dictionary of running fits and calculations indexed by</span>
<span class="sd">                    name. This dictionary is used to change the status colors of</span>
<span class="sd">                    running fits and to keep the user from editing a running</span>
<span class="sd">                    fit.</span>
<span class="sd">    quitting    --  A boolean that is set when the program is quitting. This</span>
<span class="sd">                    flag tells the error handlers to ignore any errors that take</span>
<span class="sd">                    place during shutdown.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;style&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">DEFAULT_FRAME_STYLE</span>

        <span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">SetMinSize</span><span class="p">((</span><span class="mi">700</span><span class="p">,</span> <span class="mi">500</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AuiManager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span> <span class="o">=</span> <span class="n">FitTree</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TR_HAS_BUTTONS</span>
            <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TR_NO_LINES</span>
            <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TR_EDIT_LABELS</span>
            <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TR_MULTIPLE</span>
            <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TR_HIDE_ROOT</span>
            <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TR_MULTIPLE</span>
            <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TR_DEFAULT_STYLE</span>
            <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">SUNKEN_BORDER</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span> <span class="o">=</span> <span class="n">PlotPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputPanel</span> <span class="o">=</span> <span class="n">OutputPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journalPanel</span> <span class="o">=</span> <span class="n">JournalPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panelDynamic</span> <span class="o">=</span> <span class="n">BlankPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__customProperties</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TREE_SEL_CHANGING</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onTreeSelChanging</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TREE_SEL_CHANGED</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onTreeSelChanged</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TREE_END_LABEL_EDIT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onEndLabelEdit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TREE_BEGIN_LABEL_EDIT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onBeginLabelEdit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__customBindings</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__cmdLineLoad</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateTitle</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">switchRightPanel</span><span class="p">(</span><span class="s2">&quot;welcome&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># USER CONFIGURATION CODE #################################################</span>

    <span class="k">def</span> <span class="nf">__cmdLineLoad</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Open file loaded from the command line.</span>

<span class="sd">        This opens a file without any checking for existing projects. This</span>
<span class="sd">        should only be called after all initializations. It will open a file</span>
<span class="sd">        whose name is specified in pdfguiglobals.cmdargs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pdfguiglobals</span><span class="o">.</span><span class="n">cmdargs</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">pdfguiglobals</span><span class="o">.</span><span class="n">cmdargs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">fullpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">treelist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fullpath</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">ExtendProjectTree</span><span class="p">(</span><span class="n">treelist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span> <span class="o">=</span> <span class="n">fullpath</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">fullpath</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fileHistory</span><span class="o">.</span><span class="n">AddFileToHistory</span><span class="p">(</span><span class="n">fullpath</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">__defineLocalIds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Several user functions are duplicated many times throughout the gui.</span>
<span class="sd">        This occurrs mostly between the main menu, the right-click menu, and the</span>
<span class="sd">        many buttons in the gui. This method defines local Ids that can be used</span>
<span class="sd">        for all of these.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Functions that modify the tree.</span>
        <span class="c1"># These are used in the fitting right-click menu and the main menu.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newFitId</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span>  <span class="c1"># New Fit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newCalcId</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span>  <span class="c1"># New Calculation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newPhaseId</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span>  <span class="c1"># New Phase</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newDataId</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span>  <span class="c1"># New Data Set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deleteId</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_DELETE</span>  <span class="c1"># Delete tree item</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copyId</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_COPY</span>  <span class="c1"># Copy a tree item</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pasteId</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_PASTE</span>  <span class="c1"># Paste a tree item into tree</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pasteLinkId</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span>  <span class="c1"># Paste and link a fit node</span>

        <span class="c1"># Misc. functions, these are exclusive to the main menu.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newId</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_NEW</span>  <span class="c1"># Start a new Project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">openId</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OPEN</span>  <span class="c1"># Open a project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recentId</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Open a recent project (set later)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveId</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_SAVE</span>  <span class="c1"># Save the project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveAsId</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_SAVEAS</span>  <span class="c1"># Save the project as...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quitId</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_CLOSE</span>  <span class="c1"># Quit the program</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runFitId</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span>  <span class="c1"># Run a fit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopFitId</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span>  <span class="c1"># Stop a fit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quickPlotId</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span>  <span class="c1"># Quick plot a fit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exportFitPDFId</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span>  <span class="c1"># Save a fit PDF</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exportFitStruId</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span>  <span class="c1"># Save a fit structure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exportNewStruId</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span>  <span class="c1"># Export a &#39;new&#39; structure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotIStructId</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span>  <span class="c1"># Plot initial structure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotFStructId</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span>  <span class="c1"># Plot final structure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printBLId</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span>  <span class="c1"># Print the bond lengths of a structure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printBAId</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span>  <span class="c1"># Print the bond angles of a structure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exportResId</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span>  <span class="c1"># Save the results file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runCalcId</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span>  <span class="c1"># Run a calculation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exportCalcPDFId</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">()</span>  <span class="c1"># Save a calculated PDF</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">__customProperties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Custom Properties go here.&quot;&quot;&quot;</span>
        <span class="c1"># Set some visual stuff</span>
        <span class="n">icon</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Icon</span><span class="p">(</span><span class="n">iconpath</span><span class="p">(</span><span class="s2">&quot;pdfgui.ico&quot;</span><span class="p">),</span> <span class="n">wx</span><span class="o">.</span><span class="n">BITMAP_TYPE_ANY</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetIcon</span><span class="p">(</span><span class="n">icon</span><span class="p">)</span>

        <span class="c1"># The panel should know its name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">pdfguiglobals</span><span class="o">.</span><span class="n">name</span>

        <span class="c1"># The fit tree needs a copy of the control, as</span>
        <span class="c1"># most interactions with the control happen there.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control</span> <span class="o">=</span> <span class="n">pdfguicontrol</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">startQueue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">control</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">control</span>

        <span class="c1"># Constants needed for communication with the control</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ERROR</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UPDATE</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OUTPUT</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PLOTNOW</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span>

        <span class="c1"># Needed for the error checker so it doesn&#39;t throw errors at quit time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quitting</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Wrap the events to use an event handler</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainFrame</span> <span class="o">=</span> <span class="bp">self</span>  <span class="c1"># needed by error wrapper</span>
        <span class="n">catchObjectErrors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Needed for loading and saving</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">workpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

        <span class="c1"># The dictionary of running fits/calculations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runningDict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># The configuration parser for getting configuration data.</span>
        <span class="c1"># self.cP = QuotedConfigParser()</span>
        <span class="c1"># Long try this to avoid DuplicateSectionError and ParsingError</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cP</span> <span class="o">=</span> <span class="n">QuotedConfigParser</span><span class="p">(</span><span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_no_value</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Set the program mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;fitting&quot;</span>

        <span class="c1"># This is the dictionary of right panels. For simplicity the five panels</span>
        <span class="c1"># corresponding to the five tree item types are given the name of the</span>
        <span class="c1"># data type (fit, dataset, phase, calculation). This allows for</span>
        <span class="c1"># automatic switching of panels.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dynamicPanels</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;blank&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">panelDynamic</span><span class="p">,</span>
            <span class="s2">&quot;welcome&quot;</span><span class="p">:</span> <span class="n">WelcomePanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
            <span class="s2">&quot;fit&quot;</span><span class="p">:</span> <span class="n">FitNotebookPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
            <span class="s2">&quot;phase&quot;</span><span class="p">:</span> <span class="n">PhaseNotebookPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
            <span class="s2">&quot;dataset&quot;</span><span class="p">:</span> <span class="n">DataSetPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
            <span class="s2">&quot;calculation&quot;</span><span class="p">:</span> <span class="n">CalculationPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
            <span class="s2">&quot;adddata&quot;</span><span class="p">:</span> <span class="n">AddDataPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
            <span class="s2">&quot;addphase&quot;</span><span class="p">:</span> <span class="n">AddPhasePanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
            <span class="s2">&quot;preferences&quot;</span><span class="p">:</span> <span class="n">PreferencesPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
            <span class="s2">&quot;rseries&quot;</span><span class="p">:</span> <span class="n">RSeriesPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
            <span class="s2">&quot;tseries&quot;</span><span class="p">:</span> <span class="n">TemperatureSeriesPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
            <span class="s2">&quot;dseries&quot;</span><span class="p">:</span> <span class="n">DopingSeriesPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="c1"># Prepare the right pane. Display the welcome screen.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">panelDynamic</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamicPanels</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">AddPane</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dynamicPanels</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AuiPaneInfo</span><span class="p">()</span>
                <span class="o">.</span><span class="n">Name</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="o">.</span><span class="n">CenterPane</span><span class="p">()</span>
                <span class="o">.</span><span class="n">BestSize</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">380</span><span class="p">))</span>
                <span class="o">.</span><span class="n">MinSize</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">190</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
                <span class="o">.</span><span class="n">Hide</span><span class="p">(),</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dynamicPanels</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">mainFrame</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dynamicPanels</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">treeCtrlMain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dynamicPanels</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">cP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cP</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dynamicPanels</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dynamicPanels</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Do the same for the plotPanel and journalPanel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span><span class="o">.</span><span class="n">mainFrame</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span><span class="o">.</span><span class="n">treeCtrlMain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span><span class="o">.</span><span class="n">cP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">journalPanel</span><span class="o">.</span><span class="n">mainFrame</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journalPanel</span><span class="o">.</span><span class="n">treeCtrlMain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journalPanel</span><span class="o">.</span><span class="n">cP</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cP</span>

        <span class="c1"># Position other panels. Note that currently MinimizeButton does not do</span>
        <span class="c1"># anything. It is to be implemented in future versions of wx.aui</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">AddPane</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outputPanel</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AuiPaneInfo</span><span class="p">()</span>
            <span class="o">.</span><span class="n">Name</span><span class="p">(</span><span class="s2">&quot;outputPanel&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">Caption</span><span class="p">(</span><span class="s2">&quot;PDFfit2 Output&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">Bottom</span><span class="p">()</span>
            <span class="o">.</span><span class="n">TopDockable</span><span class="p">()</span>
            <span class="o">.</span><span class="n">BottomDockable</span><span class="p">()</span>
            <span class="o">.</span><span class="n">LeftDockable</span><span class="p">()</span>
            <span class="o">.</span><span class="n">RightDockable</span><span class="p">()</span>
            <span class="o">.</span><span class="n">MinimizeButton</span><span class="p">()</span>
            <span class="o">.</span><span class="n">BestSize</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">40</span><span class="p">))</span>
            <span class="o">.</span><span class="n">MinSize</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">40</span><span class="p">)),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">AddPane</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AuiPaneInfo</span><span class="p">()</span>
            <span class="o">.</span><span class="n">Name</span><span class="p">(</span><span class="s2">&quot;treeCtrlMain&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">Caption</span><span class="p">(</span><span class="s2">&quot;Fit Tree&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">Left</span><span class="p">()</span>
            <span class="o">.</span><span class="n">TopDockable</span><span class="p">()</span>
            <span class="o">.</span><span class="n">BottomDockable</span><span class="p">()</span>
            <span class="o">.</span><span class="n">LeftDockable</span><span class="p">()</span>
            <span class="o">.</span><span class="n">RightDockable</span><span class="p">()</span>
            <span class="o">.</span><span class="n">MinimizeButton</span><span class="p">()</span>
            <span class="o">.</span><span class="n">BestSize</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
            <span class="o">.</span><span class="n">MinSize</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">40</span><span class="p">)),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">AddPane</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AuiPaneInfo</span><span class="p">()</span>
            <span class="o">.</span><span class="n">Name</span><span class="p">(</span><span class="s2">&quot;plotPanel&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">Caption</span><span class="p">(</span><span class="s2">&quot;Plot Control&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">Left</span><span class="p">()</span>
            <span class="o">.</span><span class="n">TopDockable</span><span class="p">()</span>
            <span class="o">.</span><span class="n">BottomDockable</span><span class="p">()</span>
            <span class="o">.</span><span class="n">LeftDockable</span><span class="p">()</span>
            <span class="o">.</span><span class="n">RightDockable</span><span class="p">()</span>
            <span class="o">.</span><span class="n">MinimizeButton</span><span class="p">()</span>
            <span class="o">.</span><span class="n">BestSize</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">))</span>
            <span class="o">.</span><span class="n">MinSize</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">150</span><span class="p">)),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">AddPane</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">journalPanel</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AuiPaneInfo</span><span class="p">()</span>
            <span class="o">.</span><span class="n">Name</span><span class="p">(</span><span class="s2">&quot;journalPanel&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">Caption</span><span class="p">(</span><span class="s2">&quot;Project Journal&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">TopDockable</span><span class="p">()</span>
            <span class="o">.</span><span class="n">BottomDockable</span><span class="p">()</span>
            <span class="o">.</span><span class="n">LeftDockable</span><span class="p">()</span>
            <span class="o">.</span><span class="n">RightDockable</span><span class="p">()</span>
            <span class="o">.</span><span class="n">MinimizeButton</span><span class="p">()</span>
            <span class="o">.</span><span class="n">Hide</span><span class="p">()</span>
            <span class="o">.</span><span class="n">BestSize</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">450</span><span class="p">,</span> <span class="mi">450</span><span class="p">))</span>
            <span class="o">.</span><span class="n">MinSize</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
            <span class="o">.</span><span class="n">FloatingSize</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">450</span><span class="p">,</span> <span class="mi">450</span><span class="p">))</span>
            <span class="o">.</span><span class="n">Float</span><span class="p">(),</span>
        <span class="p">)</span>

        <span class="c1"># Continue with initialization</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__defineLocalIds</span><span class="p">()</span>  <span class="c1"># Ids for menu items</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__setupMainMenu</span><span class="p">()</span>  <span class="c1"># Make the main menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__setupToolBar</span><span class="p">()</span>  <span class="c1"># Make the toolbar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">InitializeTree</span><span class="p">()</span>  <span class="c1"># Initialize the tree</span>

        <span class="c1"># Load the configuration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loadConfiguration</span><span class="p">()</span>

        <span class="c1"># Set the state of the program</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">needsSave</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">__setupMainMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This sets up the menu in the main frame.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menulength</span> <span class="o">=</span> <span class="mi">8</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetMenuBar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">)</span>

        <span class="c1"># File Menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newId</span><span class="p">,</span> <span class="s2">&quot;&amp;New Project</span><span class="se">\t</span><span class="s2">Ctrl+n&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">openItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">openId</span><span class="p">,</span> <span class="s2">&quot;&amp;Open Project</span><span class="se">\t</span><span class="s2">Ctrl+o&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">openItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recentMenu</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="n">msub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="o">.</span><span class="n">AppendSubMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recentMenu</span><span class="p">,</span> <span class="s2">&quot;&amp;Recent Files&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recentId</span> <span class="o">=</span> <span class="n">msub</span><span class="o">.</span><span class="n">Id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveId</span><span class="p">,</span> <span class="s2">&quot;&amp;Save Project</span><span class="se">\t</span><span class="s2">Ctrl+s&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveAsItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">saveAsId</span><span class="p">,</span>
            <span class="s2">&quot;Save Project &amp;as</span><span class="se">\t</span><span class="s2">Ctrl+Shift+s&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveAsItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quitItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quitId</span><span class="p">,</span> <span class="s2">&quot;&amp;Quit</span><span class="se">\t</span><span class="s2">Ctrl+q&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quitItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fileMenu</span><span class="p">,</span> <span class="s2">&quot;&amp;File&quot;</span><span class="p">)</span>
        <span class="c1"># End File Menu</span>

        <span class="c1"># Edit Menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">deleteId</span><span class="p">,</span> <span class="s2">&quot;&amp;Delete Item(s)</span><span class="se">\t</span><span class="s2">Ctrl+X&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copyItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">copyId</span><span class="p">,</span> <span class="s2">&quot;&amp;Copy Item</span><span class="se">\t</span><span class="s2">Ctrl+C&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copyItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pasteItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pasteId</span><span class="p">,</span> <span class="s2">&quot;&amp;Paste Item</span><span class="se">\t</span><span class="s2">Ctrl+V&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pasteLinkItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pasteLinkId</span><span class="p">,</span> <span class="s2">&quot;Paste &amp;Linked Fit&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteLinkItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prefItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span><span class="p">,</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">(),</span> <span class="s2">&quot;&amp;Preferences&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prefItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span><span class="p">,</span> <span class="s2">&quot;&amp;Edit&quot;</span><span class="p">)</span>
        <span class="c1"># End Edit Menu</span>

        <span class="c1"># View Menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewMenu</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">defaultLayoutItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editMenu</span><span class="p">,</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">(),</span> <span class="s2">&quot;Default Window Layout&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">defaultLayoutItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewMenu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="c1"># These items are context sensitive.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showFitItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">viewMenu</span><span class="p">,</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">(),</span> <span class="s2">&quot;Show Fit Tree&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">showFitItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showPlotItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">viewMenu</span><span class="p">,</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">(),</span> <span class="s2">&quot;Show Plot Control&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">showPlotItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showOutputItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">viewMenu</span><span class="p">,</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">(),</span> <span class="s2">&quot;Show Output&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">showOutputItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showJournalItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">viewMenu</span><span class="p">,</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">(),</span> <span class="s2">&quot;Show Journal</span><span class="se">\t</span><span class="s2">Ctrl+j&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">showJournalItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">viewMenu</span><span class="p">,</span> <span class="s2">&quot;&amp;View&quot;</span><span class="p">)</span>

        <span class="c1"># Fits Menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fitsMenu</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newFitItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fitsMenu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newFitId</span><span class="p">,</span> <span class="s2">&quot;&amp;New Fit</span><span class="se">\t</span><span class="s2">Ctrl+t&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fitsMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newFitItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fitsMenu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runFitItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fitsMenu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">runFitId</span><span class="p">,</span> <span class="s2">&quot;&amp;Run Selected Fits&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fitsMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runFitItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopFitItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fitsMenu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopFitId</span><span class="p">,</span> <span class="s2">&quot;&amp;Stop Fitting&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fitsMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stopFitItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fitsMenu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expResItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fitsMenu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">exportResId</span><span class="p">,</span> <span class="s2">&quot;Export Resu&amp;lts File&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fitsMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expResItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fitsMenu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="c1"># Macros sub-menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">macrosMenu</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rseriesItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">macrosMenu</span><span class="p">,</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">(),</span> <span class="s2">&quot;r-Series&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">macrosMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rseriesItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tseriesItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">macrosMenu</span><span class="p">,</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">(),</span> <span class="s2">&quot;Temperature Series&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">macrosMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tseriesItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dseriesItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">macrosMenu</span><span class="p">,</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">(),</span> <span class="s2">&quot;Doping Series&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">macrosMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dseriesItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fitsMenu</span><span class="o">.</span><span class="n">AppendSubMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">macrosMenu</span><span class="p">,</span> <span class="s2">&quot;Macros&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fitsMenu</span><span class="p">,</span> <span class="s2">&quot;Fi&amp;ts&quot;</span><span class="p">)</span>
        <span class="c1"># End Fits Menu</span>

        <span class="c1"># Phases Menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phasesMenu</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newPhaseItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phasesMenu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newPhaseId</span><span class="p">,</span> <span class="s2">&quot;&amp;New Phase</span><span class="se">\t</span><span class="s2">Ctrl+p&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phasesMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newPhaseItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phasesMenu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printBLItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phasesMenu</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">printBLId</span><span class="p">,</span>
            <span class="s2">&quot;Calculate bond lengths&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phasesMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printBLItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">printBAItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phasesMenu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">printBAId</span><span class="p">,</span> <span class="s2">&quot;Calculate bond angles&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phasesMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printBAItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phasesMenu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expNewPhaseItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phasesMenu</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exportNewStruId</span><span class="p">,</span>
            <span class="s2">&quot;Export &amp;Selected Phase&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phasesMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expNewPhaseItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expStruItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fitsMenu</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exportFitStruId</span><span class="p">,</span>
            <span class="s2">&quot;&amp;Export Fit Structure&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phasesMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expStruItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phasesMenu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotIStructItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phasesMenu</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotIStructId</span><span class="p">,</span>
            <span class="s2">&quot;&amp;Plot Initial Structure&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phasesMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotIStructItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotFStructItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phasesMenu</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotFStructId</span><span class="p">,</span>
            <span class="s2">&quot;&amp;Plot Final Structure&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phasesMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotFStructItem</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phasesMenu</span><span class="p">,</span> <span class="s2">&quot;&amp;Phases&quot;</span><span class="p">)</span>
        <span class="c1"># End Phases Menu</span>

        <span class="c1"># Data Menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataMenu</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newDataItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataMenu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newDataId</span><span class="p">,</span> <span class="s2">&quot;&amp;New Data Set</span><span class="se">\t</span><span class="s2">Ctrl+d&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newDataItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataMenu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expFitPDFItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fitsMenu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">exportFitPDFId</span><span class="p">,</span> <span class="s2">&quot;&amp;Export Fit PDF&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expFitPDFItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataMenu</span><span class="p">,</span> <span class="s2">&quot;&amp;Data&quot;</span><span class="p">)</span>
        <span class="c1"># End Data Menu</span>

        <span class="c1"># Calculations Menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calcMenu</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newCalcItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calcMenu</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newCalcId</span><span class="p">,</span>
            <span class="s2">&quot;&amp;New Calculation</span><span class="se">\t</span><span class="s2">Ctrl+l&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calcMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newCalcItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calcMenu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runCalcItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calcMenu</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">runCalcId</span><span class="p">,</span>
            <span class="s2">&quot;&amp;Run Selected Calculation&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calcMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runCalcItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calcMenu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expCalcPDFItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calcMenu</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exportCalcPDFId</span><span class="p">,</span>
            <span class="s2">&quot;&amp;Export Selected Calculation&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calcMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expCalcPDFItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calcMenu</span><span class="p">,</span> <span class="s2">&quot;Ca&amp;lculations&quot;</span><span class="p">)</span>
        <span class="c1"># End Calculations Menu</span>

        <span class="c1"># Help Menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">docItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span><span class="p">,</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">(),</span> <span class="s2">&quot;&amp;Documentation</span><span class="se">\t</span><span class="s2">F1&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">docItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">requestItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span><span class="p">,</span>
            <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">(),</span>
            <span class="s2">&quot;Request a Feature / Report a Bug&quot;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">requestItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">communityItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span><span class="p">,</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">(),</span> <span class="s2">&quot;PDFgui Community&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">communityItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aboutItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span><span class="p">,</span> <span class="n">wx12</span><span class="o">.</span><span class="n">NewIdRef</span><span class="p">(),</span> <span class="s2">&quot;&amp;About&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aboutItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">helpMenu</span><span class="p">,</span> <span class="s2">&quot;&amp;Help&quot;</span><span class="p">)</span>
        <span class="c1"># End Help Menu</span>

        <span class="c1"># For managing MRUs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileHistory</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileHistory</span><span class="p">(</span><span class="n">pdfguiglobals</span><span class="o">.</span><span class="n">MAXMRU</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileHistory</span><span class="o">.</span><span class="n">UseMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recentMenu</span><span class="p">)</span>

        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">__setupToolBar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This sets up the tool bar in the parent window.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CreateToolBar</span><span class="p">()</span>
        <span class="n">wx12</span><span class="o">.</span><span class="n">patchToolBarMethods</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="p">)</span>
        <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
        <span class="n">bitmap</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ArtProvider</span><span class="o">.</span><span class="n">GetBitmap</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ART_NEW</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ART_TOOLBAR</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">AddTool</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newId</span><span class="p">,</span>
            <span class="s2">&quot;New Project&quot;</span><span class="p">,</span>
            <span class="n">bitmap</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">NullBitmap</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="s2">&quot;Start a new project&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">bitmap</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ArtProvider</span><span class="o">.</span><span class="n">GetBitmap</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ART_FILE_OPEN</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ART_TOOLBAR</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">AddTool</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">openId</span><span class="p">,</span>
            <span class="s2">&quot;Open Project&quot;</span><span class="p">,</span>
            <span class="n">bitmap</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">NullBitmap</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="s2">&quot;Open an existing project&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">bitmap</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ArtProvider</span><span class="o">.</span><span class="n">GetBitmap</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ART_FILE_SAVE</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ART_TOOLBAR</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">AddTool</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">saveId</span><span class="p">,</span>
            <span class="s2">&quot;Save Project&quot;</span><span class="p">,</span>
            <span class="n">bitmap</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">NullBitmap</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="s2">&quot;Save this project&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">AddSeparator</span><span class="p">()</span>
        <span class="c1"># This fixes the shadowing problem on Windows.</span>
        <span class="c1"># The bitmap has a white transparency color (mask)</span>
        <span class="n">maskcolor</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Colour</span><span class="p">(</span><span class="n">red</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">green</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">blue</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
        <span class="n">bitmap</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Bitmap</span><span class="p">(</span><span class="n">iconpath</span><span class="p">(</span><span class="s2">&quot;run.png&quot;</span><span class="p">))</span>
        <span class="n">bitmap</span><span class="o">.</span><span class="n">SetSize</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Mask</span><span class="p">(</span><span class="n">bitmap</span><span class="p">,</span> <span class="n">maskcolor</span><span class="p">)</span>
        <span class="n">bitmap</span><span class="o">.</span><span class="n">SetMask</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">AddTool</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">runFitId</span><span class="p">,</span>
            <span class="s2">&quot;Start&quot;</span><span class="p">,</span>
            <span class="n">bitmap</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">NullBitmap</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="s2">&quot;Start a fit or calculation&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">bitmap</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Bitmap</span><span class="p">(</span><span class="n">iconpath</span><span class="p">(</span><span class="s2">&quot;stop.png&quot;</span><span class="p">))</span>
        <span class="n">bitmap</span><span class="o">.</span><span class="n">SetSize</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Mask</span><span class="p">(</span><span class="n">bitmap</span><span class="p">,</span> <span class="n">maskcolor</span><span class="p">)</span>
        <span class="n">bitmap</span><span class="o">.</span><span class="n">SetMask</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">AddTool</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stopFitId</span><span class="p">,</span>
            <span class="s2">&quot;Stop&quot;</span><span class="p">,</span>
            <span class="n">bitmap</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">NullBitmap</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="s2">&quot;Stop running fits or calculations&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">AddSeparator</span><span class="p">()</span>
        <span class="n">bitmap</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Bitmap</span><span class="p">(</span><span class="n">iconpath</span><span class="p">(</span><span class="s2">&quot;datasetitem.png&quot;</span><span class="p">))</span>
        <span class="n">bitmap</span><span class="o">.</span><span class="n">SetSize</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">AddTool</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">quickPlotId</span><span class="p">,</span>
            <span class="s2">&quot;Quick plot&quot;</span><span class="p">,</span>
            <span class="n">bitmap</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">NullBitmap</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="s2">&quot;Plot PDF or structure&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">Realize</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">__customBindings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Custom user bindings go here.</span>

<span class="sd">        These bindings are not present in wxglade.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Allow a general right-click to work on the tree</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_RIGHT_DOWN</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onRightClick</span><span class="p">)</span>
        <span class="c1"># Double-click select all type on tree</span>
        <span class="c1"># FIXME - this doesn&#39;t work, I suspect the problem is with the tree</span>
        <span class="c1"># selection code.</span>
        <span class="c1"># self.treeCtrlMain.Bind(wx.EVT_LEFT_DCLICK, self.onDoubleClick2)</span>
        <span class="c1"># self.Bind(wx.EVT_TREE_ITEM_ACTIVATED, self.onDoubleClick, self.treeCtrlMain)</span>
        <span class="c1"># Middle-click quickplot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TREE_ITEM_MIDDLE_CLICK</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onMiddleClick</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="p">)</span>
        <span class="c1"># Catch key events for the tree</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_KEY_DOWN</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onKey</span><span class="p">)</span>
        <span class="c1"># Catch the close event</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_CLOSE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onQuit</span><span class="p">)</span>
        <span class="c1"># Use the custom event to pop up error messages</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">EVT_PDFCUSTOM</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onCustom</span><span class="p">)</span>
        <span class="c1"># Do bindings for menu items</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__menuBindings</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__fittingRightMenuBindings</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">__menuBindings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Setup bindings for the main menu and toolbar.</span>

<span class="sd">        Since all toolbar functions use the same Ids as main menu items, the</span>
<span class="sd">        toolbar events do not need their own bindings.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># File Menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onNew</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">newId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onOpen</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">openId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onSave</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">saveId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onSaveAs</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">saveAsId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onQuit</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quitId</span><span class="p">)</span>
        <span class="c1"># For recent items</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU_RANGE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onMRUFile</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_FILE1</span><span class="p">,</span> <span class="n">id2</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_FILE5</span><span class="p">)</span>

        <span class="c1"># Edit Menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onDelete</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deleteId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onCopy</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">copyId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onPaste</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onPasteLink</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteLinkId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onPreferences</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefItem</span><span class="p">)</span>

        <span class="c1"># View menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onDefaultLayout</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultLayoutItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onShowFit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">showFitItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onShowPlot</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">showPlotItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onShowOutput</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">showOutputItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onShowJournal</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">showJournalItem</span><span class="p">)</span>

        <span class="c1"># Fits Menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onNewFit</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">newFitId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onRun</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runFitId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onStop</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stopFitId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onExportRes</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exportResId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onRSeries</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rseriesItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onTSeries</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tseriesItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onDSeries</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dseriesItem</span><span class="p">)</span>
        <span class="c1"># Macros are inserted individually</span>

        <span class="c1"># Phases Menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onInsPhase</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">newPhaseId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onPrintBL</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">printBLId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onPrintBA</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">printBAId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onExportNewStruct</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exportNewStruId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onExportStruct</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exportFitStruId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onPlotIStruct</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plotIStructId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onPlotFStruct</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plotFStructId</span><span class="p">)</span>

        <span class="c1"># Data Menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onInsData</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">newDataId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onExportPDF</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exportFitPDFId</span><span class="p">)</span>

        <span class="c1"># Calculations Menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onInsCalc</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">newCalcId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onRun</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runCalcId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onSaveCalc</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exportCalcPDFId</span><span class="p">)</span>

        <span class="c1"># Help Menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onDocumentation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">docItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onAbout</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">aboutItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onRequest</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">requestItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onCommunity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">communityItem</span><span class="p">)</span>

        <span class="c1"># The generic menu-check.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU_OPEN</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onMainMenu</span><span class="p">)</span>

        <span class="c1"># Toolbar events that have no menu item</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onQuickPlot</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">quickPlotId</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">__fittingRightMenuBindings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Bindings for the fitting-mode right-click menu.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onNewFit</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">newFitId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onCopy</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">copyId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onPaste</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onPasteLink</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteLinkId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onInsPhase</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">newPhaseId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onInsData</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">newDataId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onInsCalc</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">newCalcId</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">onDelete</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">deleteId</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># UTILITY FUNCTIONS ######################################################</span>

<div class="viewcode-block" id="MainFrame.switchRightPanel">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.switchRightPanel">[docs]</a>
    <span class="k">def</span> <span class="nf">switchRightPanel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">paneltype</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Switch the panel which is visible in the right hand side.</span>

<span class="sd">        This sets any panel-specific data and calls the refresh() method of the</span>
<span class="sd">        new rightPanel. All right panels must be derived from wxPanel and</span>
<span class="sd">        PDFPanel (in pdfpanel module).</span>

<span class="sd">        Inputs:</span>
<span class="sd">        paneltype   --  The code used in self.dynamicPanels that indicates the</span>
<span class="sd">                        panel to be displayed. If paneltype is None, the blank</span>
<span class="sd">                        panel is displayed.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamicPanels</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">Hide</span><span class="p">()</span>

        <span class="c1"># Why doesn&#39;t this work?</span>
        <span class="c1"># key = self.rightPanel.key</span>
        <span class="c1"># self.auiManager.GetPane(key).Hide()</span>

        <span class="k">if</span> <span class="n">paneltype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">paneltype</span> <span class="o">=</span> <span class="s2">&quot;blank&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamicPanels</span><span class="p">[</span><span class="n">paneltype</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setPanelSpecificData</span><span class="p">(</span><span class="n">paneltype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="n">paneinfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="n">paneltype</span><span class="p">)</span>
        <span class="n">paneinfo</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>

        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selections</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.setPanelSpecificData">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.setPanelSpecificData">[docs]</a>
    <span class="k">def</span> <span class="nf">setPanelSpecificData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">paneltype</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method sets the panel specific data for the right panel.</span>

<span class="sd">        This method gets panel-specific data and sends it to the rightPanel. The</span>
<span class="sd">        different types of data assignment are listed below.</span>

<span class="sd">        &quot;fit&quot; type:</span>
<span class="sd">        * Give the fit object to the panel</span>

<span class="sd">        &quot;phase&quot; type:</span>
<span class="sd">        * initialize constraints dictionary and configuration and results</span>
<span class="sd">        * Structure objects.</span>

<span class="sd">        &quot;dataset&quot; type:</span>
<span class="sd">        * initialize configuration, constraints, and results objects</span>

<span class="sd">        &quot;calculation&quot; type:</span>
<span class="sd">        * Give the calculation object to the panel</span>

<span class="sd">        &quot;rseries&quot; type:</span>
<span class="sd">        * Give the fit object to the panel</span>

<span class="sd">        &quot;tseries&quot; type:</span>
<span class="sd">        * Give the fit object to the panel</span>

<span class="sd">        &quot;dseries&quot; type:</span>
<span class="sd">        * Give the fit object to the panel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selections</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">dataobject</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">paneltype</span> <span class="o">==</span> <span class="s2">&quot;phase&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">configuration</span> <span class="o">=</span> <span class="n">dataobject</span><span class="o">.</span><span class="n">initial</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="n">dataobject</span><span class="o">.</span><span class="n">constraints</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">dataobject</span><span class="o">.</span><span class="n">refined</span>
            <span class="k">elif</span> <span class="n">paneltype</span> <span class="o">==</span> <span class="s2">&quot;dataset&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">configuration</span> <span class="o">=</span> <span class="n">dataobject</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="n">dataobject</span><span class="o">.</span><span class="n">constraints</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">dataobject</span><span class="o">.</span><span class="n">refined</span>
            <span class="k">elif</span> <span class="n">paneltype</span> <span class="o">==</span> <span class="s2">&quot;fit&quot;</span><span class="p">:</span>
                <span class="n">dataobject</span><span class="o">.</span><span class="n">updateParameters</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">fit</span> <span class="o">=</span> <span class="n">dataobject</span>
            <span class="k">elif</span> <span class="n">paneltype</span> <span class="o">==</span> <span class="s2">&quot;calculation&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">calculation</span> <span class="o">=</span> <span class="n">dataobject</span>
            <span class="k">elif</span> <span class="n">paneltype</span> <span class="o">==</span> <span class="s2">&quot;rseries&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">fit</span> <span class="o">=</span> <span class="n">dataobject</span>
            <span class="k">elif</span> <span class="n">paneltype</span> <span class="o">==</span> <span class="s2">&quot;tseries&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">fit</span> <span class="o">=</span> <span class="n">dataobject</span>
            <span class="k">elif</span> <span class="n">paneltype</span> <span class="o">==</span> <span class="s2">&quot;dseries&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">fit</span> <span class="o">=</span> <span class="n">dataobject</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.setMode">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.setMode">[docs]</a>
    <span class="k">def</span> <span class="nf">setMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the mode of the program.</span>

<span class="sd">        This method takes care of any widget properties that must change when</span>
<span class="sd">        the mode is changed. If the mode is changing due to the change in the</span>
<span class="sd">        right panel, always call setMode before switchRightPanel.</span>

<span class="sd">        &quot;fitting&quot; mode:</span>
<span class="sd">            * treeCtrlMain is enabled</span>
<span class="sd">            * plotPanel panel is enabled</span>
<span class="sd">            * toolBar is enabled</span>
<span class="sd">            * menuBar is enabled</span>

<span class="sd">        &quot;addingdata&quot; mode:</span>
<span class="sd">        &quot;addingphase&quot; mode:</span>
<span class="sd">        &quot;config&quot; mode:</span>
<span class="sd">            * treeCtrlMain is disabled</span>
<span class="sd">            * plotPanel panel is disabled</span>
<span class="sd">            * toolBar is disabled</span>
<span class="sd">            * menuBar is disabled</span>

<span class="sd">        &quot;rseries&quot; mode:</span>
<span class="sd">        &quot;tseries&quot; mode:</span>
<span class="sd">        &quot;dseries&quot; mode:</span>
<span class="sd">            * treeCtrlMain is enabled</span>
<span class="sd">            * plotPanel panel is disabled</span>
<span class="sd">            * toolBar is disabled</span>
<span class="sd">            * menuBar is disabled</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;fitting&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">menulength</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="o">.</span><span class="n">EnableTop</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;addingdata&quot;</span><span class="p">,</span> <span class="s2">&quot;addingphase&quot;</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">menulength</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="o">.</span><span class="n">EnableTop</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;rseries&quot;</span><span class="p">,</span> <span class="s2">&quot;tseries&quot;</span><span class="p">,</span> <span class="s2">&quot;dseries&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">menulength</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="o">.</span><span class="n">EnableTop</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.loadConfiguration">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.loadConfiguration">[docs]</a>
    <span class="k">def</span> <span class="nf">loadConfiguration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load the configuration from file.</span>

<span class="sd">        The MRU list is handled by the local member fileHistory, which is a</span>
<span class="sd">        wxFileHistory object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get MRU information</span>
        <span class="n">localpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">pdfguiglobals</span><span class="o">.</span><span class="n">configfilename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">localpath</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">localpath</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pdfguiglobals</span><span class="o">.</span><span class="n">MAXMRU</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="s2">&quot;MRU&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)):</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">getquoted</span><span class="p">(</span><span class="s2">&quot;MRU&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">fileHistory</span><span class="o">.</span><span class="n">AddFileToHistory</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

        <span class="c1"># Import perspective from last session</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">has_section</span><span class="p">(</span><span class="s2">&quot;PERSPECTIVE&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="s2">&quot;PERSPECTIVE&quot;</span><span class="p">,</span> <span class="s2">&quot;last&quot;</span><span class="p">):</span>
                <span class="n">perspective</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;PERSPECTIVE&quot;</span><span class="p">,</span> <span class="s2">&quot;last&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">LoadPerspective</span><span class="p">(</span><span class="n">perspective</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.windowperspective</span> <span class="kn">import</span> <span class="n">default</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">LoadPerspective</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>

        <span class="c1"># Load the window dimensions</span>
        <span class="n">w</span> <span class="o">=</span> <span class="mi">800</span>
        <span class="n">h</span> <span class="o">=</span> <span class="mi">600</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="s2">&quot;SIZE&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">):</span>
            <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SIZE&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">has_option</span><span class="p">(</span><span class="s2">&quot;SIZE&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">):</span>
            <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SIZE&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">)</span>
            <span class="n">h</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSize</span><span class="p">((</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>

        <span class="c1"># Load structure viewer information and put this in the configure panel</span>
        <span class="n">viewerconfig</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">has_section</span><span class="p">(</span><span class="s2">&quot;STRUCTUREVIEWER&quot;</span><span class="p">):</span>
            <span class="n">viewerconfig</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;STRUCTUREVIEWER&quot;</span><span class="p">))</span>
            <span class="n">viewer</span> <span class="o">=</span> <span class="n">structureviewer</span><span class="o">.</span><span class="n">getStructureViewer</span><span class="p">()</span>
            <span class="n">viewer</span><span class="o">.</span><span class="n">setConfig</span><span class="p">(</span><span class="n">viewerconfig</span><span class="p">)</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.updateConfiguration">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.updateConfiguration">[docs]</a>
    <span class="k">def</span> <span class="nf">updateConfiguration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the configuration information.</span>

<span class="sd">        This updates the &#39;MRU&#39; section of the configuration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Most recently used list</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">has_section</span><span class="p">(</span><span class="s2">&quot;MRU&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s2">&quot;MRU&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fileHistory</span><span class="o">.</span><span class="n">GetCount</span><span class="p">()):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileHistory</span><span class="o">.</span><span class="n">GetHistoryFile</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">setquoted</span><span class="p">(</span><span class="s2">&quot;MRU&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">item</span><span class="p">)</span>

        <span class="c1"># Window size</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">has_section</span><span class="p">(</span><span class="s2">&quot;SIZE&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s2">&quot;SIZE&quot;</span><span class="p">)</span>

        <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetSize</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;SIZE&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">w</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;SIZE&quot;</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>

        <span class="c1"># Frame layout</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">has_section</span><span class="p">(</span><span class="s2">&quot;PERSPECTIVE&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s2">&quot;PERSPECTIVE&quot;</span><span class="p">)</span>

        <span class="n">perspective</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">SavePerspective</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;PERSPECTIVE&quot;</span><span class="p">,</span> <span class="s2">&quot;last&quot;</span><span class="p">,</span> <span class="n">perspective</span><span class="p">)</span>

        <span class="c1"># Set the structure viewer information</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">has_section</span><span class="p">(</span><span class="s2">&quot;STRUCTUREVIEWER&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s2">&quot;STRUCTUREVIEWER&quot;</span><span class="p">)</span>
        <span class="n">viewer</span> <span class="o">=</span> <span class="n">structureviewer</span><span class="o">.</span><span class="n">getStructureViewer</span><span class="p">()</span>
        <span class="n">viewerconfig</span> <span class="o">=</span> <span class="n">viewer</span><span class="o">.</span><span class="n">getConfig</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">viewerconfig</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;STRUCTUREVIEWER&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.writeConfiguration">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.writeConfiguration">[docs]</a>
    <span class="k">def</span> <span class="nf">writeConfiguration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write the program configuration to file.&quot;&quot;&quot;</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">pdfguiglobals</span><span class="o">.</span><span class="n">configfilename</span><span class="p">)</span>
        <span class="n">oflags</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">O_CREAT</span> <span class="o">|</span> <span class="n">os</span><span class="o">.</span><span class="n">O_WRONLY</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">os</span><span class="o">.</span><span class="n">fdopen</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">oflags</span><span class="p">,</span> <span class="mo">0o600</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cP</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="n">emsg</span> <span class="o">=</span> <span class="s2">&quot;Cannot write configuration file </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">filename</span>
            <span class="k">raise</span> <span class="n">ControlFileError</span><span class="p">(</span><span class="n">emsg</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.checkForSave">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.checkForSave">[docs]</a>
    <span class="k">def</span> <span class="nf">checkForSave</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pop up a dialog if the project needs to be saved.</span>

<span class="sd">        returns:</span>
<span class="sd">        wx.ID_YES if the user chose to save the project.</span>
<span class="sd">        wx.ID_NO if the user chose not to save the project.</span>
<span class="sd">        wx.ID_CANCEL if they changed their mind about their action.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_NO</span>
        <span class="c1"># disable when requested in dbopts</span>
        <span class="k">if</span> <span class="n">pdfguiglobals</span><span class="o">.</span><span class="n">dbopts</span><span class="o">.</span><span class="n">noconfirm</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">code</span>
        <span class="k">if</span> <span class="n">pdfguiglobals</span><span class="o">.</span><span class="n">isAltered</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="s2">&quot;Would you like to save this session?&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Save?&quot;</span><span class="p">,</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">YES_NO</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">CANCEL</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">code</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_YES</span><span class="p">:</span>
                <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onSave</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">d</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">code</span></div>


<div class="viewcode-block" id="MainFrame.updateTitle">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.updateTitle">[docs]</a>
    <span class="k">def</span> <span class="nf">updateTitle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the title according to the name of the current file.&quot;&quot;&quot;</span>
        <span class="n">shorttitle</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>
        <span class="n">udirnamed</span> <span class="o">=</span> <span class="s2">&quot;~&quot;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span>
        <span class="n">udir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">udirnamed</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">shorttitle</span><span class="p">:</span>
            <span class="n">namedpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span>
            <span class="k">if</span> <span class="n">namedpath</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">udir</span><span class="p">):</span>
                <span class="n">namedpath</span> <span class="o">=</span> <span class="n">namedpath</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">udir</span><span class="p">,</span> <span class="n">udirnamed</span><span class="p">)</span>
            <span class="n">fulltitle</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) - </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">shorttitle</span><span class="p">,</span> <span class="n">namedpath</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fulltitle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="n">fulltitle</span><span class="p">)</span>
        <span class="k">return</span></div>


    <span class="c1"># MAIN PANEL EVENT CODE #######################################################</span>

<div class="viewcode-block" id="MainFrame.onMainMenu">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onMainMenu">[docs]</a>
    <span class="k">def</span> <span class="nf">onMainMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare the main menu whenever it is activated.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disableMainMenuItems</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.makeTreeSelection">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.makeTreeSelection">[docs]</a>
    <span class="k">def</span> <span class="nf">makeTreeSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Manually select a node of the tree and update according to selection.</span>

<span class="sd">        This makes sure that the node is visible after selection.</span>

<span class="sd">        If node is None, this does nothing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SelectItem</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="c1"># Make sure that the node is visible.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SetFocus</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">EnsureVisible</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">ScrollTo</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">treeSelectionUpdate</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="c1"># The right-panel probably stole focus, but we want it back.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SetFocus</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.treeSelectionUpdate">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.treeSelectionUpdate">[docs]</a>
    <span class="k">def</span> <span class="nf">treeSelectionUpdate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the widgets based on a tree selection.</span>

<span class="sd">        &quot;fitting&quot; mode:</span>
<span class="sd">        * Right panel changes depending upon the type of item selected from the</span>
<span class="sd">        tree.</span>

<span class="sd">        &quot;rseries&quot;, &quot;tseries&quot;, &quot;dseries&quot; mode:</span>
<span class="sd">        * The behavior is defined in the associated panel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>

        <span class="c1"># &quot;fitting&quot; mode</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;fitting&quot;</span><span class="p">:</span>
            <span class="c1"># This doesn&#39;t work on Windows.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selections</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">switchRightPanel</span><span class="p">(</span><span class="s2">&quot;blank&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="c1"># return</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">selections</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">Enable</span><span class="p">()</span>
                <span class="n">selectiontype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">switchRightPanel</span><span class="p">(</span><span class="n">selectiontype</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Don&#39;t let the user edit the right panel of a running fit.</span>
            <span class="n">fp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetFitRoot</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">fp</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">runningDict</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;rseries&quot;</span><span class="p">,</span> <span class="s2">&quot;tseries&quot;</span><span class="p">,</span> <span class="s2">&quot;dseries&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">treeSelectionUpdate</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="c1"># Update the plotPanel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>

        <span class="c1"># update the toolbar and menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateToolbar</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runningDict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disableMainMenuItems</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onTreeSelChanged">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onTreeSelChanged">[docs]</a>
    <span class="k">def</span> <span class="nf">onTreeSelChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the click behavior for each mode.&quot;&quot;&quot;</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetItem</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeSelectionUpdate</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onTreeSelChanging">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onTreeSelChanging">[docs]</a>
    <span class="k">def</span> <span class="nf">onTreeSelChanging</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>  <span class="c1"># wxGlade: MainPanel.&lt;event_handler&gt;</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the click behavior for each mode.</span>

<span class="sd">        Note that this doesn&#39;t work on Windows. Be sure to build in redundancy</span>
<span class="sd">        so that the program behaves as if this does not even get called. If the</span>
<span class="sd">        Windows bug does not get fixed, this method will probably be</span>
<span class="sd">        eliminated.</span>

<span class="sd">        &quot;addingdata&quot; mode:</span>
<span class="sd">            * can select nothing</span>

<span class="sd">        &quot;addingphase&quot; mode:</span>
<span class="sd">            * can select nothing</span>

<span class="sd">         &quot;config&quot; mode:</span>
<span class="sd">            * can select nothing</span>

<span class="sd">         &quot;rseries&quot; mode:</span>
<span class="sd">            * can only select fit items</span>

<span class="sd">         &quot;tseries&quot; mode:</span>
<span class="sd">            * can only select fit items</span>

<span class="sd">         &quot;dseries&quot; mode:</span>
<span class="sd">            * can only select fit items</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># THIS DOESNT WORK ON WINDOWS!</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetItem</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">node</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;addingdata&quot;</span><span class="p">,</span> <span class="s2">&quot;addingphase&quot;</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">]:</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Veto</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;rseries&quot;</span><span class="p">,</span> <span class="s2">&quot;tseries&quot;</span><span class="p">,</span> <span class="s2">&quot;dseries&quot;</span><span class="p">]:</span>
            <span class="n">nodetype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nodetype</span> <span class="o">!=</span> <span class="s2">&quot;fit&quot;</span><span class="p">:</span>
                <span class="n">event</span><span class="o">.</span><span class="n">Veto</span><span class="p">()</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onBeginLabelEdit">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onBeginLabelEdit">[docs]</a>
    <span class="k">def</span> <span class="nf">onBeginLabelEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>  <span class="c1"># wxGlade: MainPanel.&lt;event_handler&gt;</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Veto editing of some items and in some modes.</span>

<span class="sd">        The following editing attempts are Veto()&#39;d</span>
<span class="sd">        * Editing any item in &quot;addingdata&quot;, &quot;addingphase&quot;, or &quot;config&quot; mode.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nodetype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">GetItem</span><span class="p">())</span>
        <span class="c1"># silence the pyflakes syntax checker</span>
        <span class="k">assert</span> <span class="n">nodetype</span> <span class="ow">or</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;fitting&quot;</span><span class="p">:</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Veto</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onEndLabelEdit">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onEndLabelEdit">[docs]</a>
    <span class="k">def</span> <span class="nf">onEndLabelEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>  <span class="c1"># wxGlade: MainPanel.&lt;event_handler&gt;</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Allow only certain types of renaming.</span>

<span class="sd">        The following rename attempts are Veto()&#39;d</span>
<span class="sd">        * Giving a node the same name as a sibling. Cousins can share names.</span>
<span class="sd">        * Giving a node the name &#39;&#39;. Everything needs a name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetLabel</span><span class="p">()</span>

        <span class="c1"># No &#39;&#39;</span>
        <span class="k">if</span> <span class="n">label</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Veto</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># No sibling&#39;s sharing the same name. (Sorry, George Foreman.)</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetItem</span><span class="p">()</span>
        <span class="n">siblings</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSiblings</span><span class="p">(</span><span class="n">node</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">siblings</span><span class="p">:</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Veto</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="c1"># Notify the control of the rename</span>
        <span class="n">cdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">cdata</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">needsSave</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onRightClick">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onRightClick">[docs]</a>
    <span class="k">def</span> <span class="nf">onRightClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>  <span class="c1"># wxGlade: MainPanel.&lt;event_handler&gt;</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Bring up the right-click menu.</span>

<span class="sd">        This menu can give a different menu depending upon which mode the</span>
<span class="sd">        program is in. It can even give a different menu depending upon what</span>
<span class="sd">        part of the tree is selected.</span>

<span class="sd">        &quot;fitting&quot; mode</span>
<span class="sd">        The menu appears for right-clicks both on and off of tree items.</span>
<span class="sd">        The menu has the following items:</span>
<span class="sd">        &quot;New Fit&quot;           --  Append a new fit from anywhere on the tree.</span>
<span class="sd">        &quot;Copy&quot;              --  Copy a fit, phase, dataset, or calc branch</span>
<span class="sd">        &quot;Paste&quot;             --  Paste a copied branch into the tree. Branches</span>
<span class="sd">                                of a given type can only be pasted in certain</span>
<span class="sd">                                places.</span>
<span class="sd">        &quot;Delete&quot;            --  Delete a branch from the tree.</span>
<span class="sd">        &quot;Insert Phase&quot;      --  Insert a phase in the phase section of a fit or</span>
<span class="sd">                                calculation branch.</span>
<span class="sd">        &quot;Insert Data Set&quot;   --  Insert a dataset in the dataset section of a fit</span>
<span class="sd">                                branch.</span>
<span class="sd">        &quot;Insert Calculation&quot;--  Insert a calculation in the calculation section</span>
<span class="sd">                                of a fit.</span>

<span class="sd">        The menu appears for right-clicks both on and off of tree items.</span>
<span class="sd">        The menu has the following items:</span>
<span class="sd">        &quot;Select All&quot;        --  The tree automatically selects all items of the</span>
<span class="sd">                                type the user clicked on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># This menu is disabled the if item is part of a running fit.</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">selections</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetFitRoot</span><span class="p">(</span><span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">nodetype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="c1"># silence the pyflakes syntax checker</span>
            <span class="k">assert</span> <span class="n">nodetype</span> <span class="ow">or</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">runningDict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;fitting&quot;</span><span class="p">:</span>

            <span class="c1"># The menu Ids are defined in __defineLocalIds.</span>
            <span class="n">menu</span> <span class="o">=</span> <span class="n">wx12</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newFitId</span><span class="p">,</span> <span class="s2">&quot;New Fit&quot;</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copyId</span><span class="p">,</span> <span class="s2">&quot;Copy&quot;</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteId</span><span class="p">,</span> <span class="s2">&quot;Paste&quot;</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteLinkId</span><span class="p">,</span> <span class="s2">&quot;Paste Linked Fit&quot;</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deleteId</span><span class="p">,</span> <span class="s2">&quot;Delete&quot;</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newPhaseId</span><span class="p">,</span> <span class="s2">&quot;Insert Phase&quot;</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newDataId</span><span class="p">,</span> <span class="s2">&quot;Insert Data Set&quot;</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newCalcId</span><span class="p">,</span> <span class="s2">&quot;Insert Calculation&quot;</span><span class="p">)</span>

            <span class="c1"># Get the item we&#39;ve right clicked on</span>
            <span class="n">itemtype</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetX</span><span class="p">()</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetY</span><span class="p">()</span>
            <span class="n">node</span><span class="p">,</span> <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">HitTest</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">flags</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">TREE_HITTEST_ABOVE</span><span class="p">,</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">TREE_HITTEST_BELOW</span><span class="p">,</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">TREE_HITTEST_NOWHERE</span><span class="p">,</span>
            <span class="p">]:</span>
                <span class="c1"># The hit is not on an item.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">UnselectAll</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">switchRightPanel</span><span class="p">(</span><span class="s2">&quot;blank&quot;</span><span class="p">)</span>
                <span class="n">selections</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># Select the item with a right click, but don&#39;t add it to an</span>
            <span class="c1"># existing selection.</span>
            <span class="k">elif</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">selections</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">UnselectAll</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SelectItem</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="n">selections</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span><span class="p">]</span>
            <span class="n">itemtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="c1"># silence the pyflakes syntax checker</span>
            <span class="k">assert</span> <span class="n">itemtype</span> <span class="ow">or</span> <span class="kc">True</span>
            <span class="c1"># Enable/Disable certain entries based upon where we clicked.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disableSharedMenuItems</span><span class="p">(</span><span class="n">menu</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Bring up the popup menu. Must have the coordinates of the right-click</span>
        <span class="c1"># event that summoned the menu.</span>

        <span class="c1"># This is to position the menu correctly on a floating frame.</span>
        <span class="c1"># wx.treeCtrlMain.GetPosition() will return (0,0) if the frame is</span>
        <span class="c1"># not docked. This is a bit of a hack, since pane.floating_pos is not</span>
        <span class="c1"># designed to be a public attribute.</span>
        <span class="n">pane</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="s2">&quot;treeCtrlMain&quot;</span><span class="p">)</span>
        <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetPosition</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pane</span><span class="o">.</span><span class="n">IsFloating</span><span class="p">():</span>
            <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ScreenToClient</span><span class="p">(</span><span class="n">pane</span><span class="o">.</span><span class="n">floating_pos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PopupMenu</span><span class="p">(</span><span class="n">menu</span><span class="p">,</span> <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">x</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">y</span><span class="p">))</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onMiddleClick">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onMiddleClick">[docs]</a>
    <span class="k">def</span> <span class="nf">onMiddleClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Quickplot on item middle click.&quot;&quot;&quot;</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetItem</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">UnselectAll</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SelectItem</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">onQuickPlot</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onDoubleClick2">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onDoubleClick2">[docs]</a>
    <span class="k">def</span> <span class="nf">onDoubleClick2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Select-all type on item double click.&quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetX</span><span class="p">()</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetY</span><span class="p">()</span>
        <span class="n">node</span><span class="p">,</span> <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">HitTest</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">flags</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">TREE_HITTEST_ABOVE</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">TREE_HITTEST_BELOW</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">TREE_HITTEST_NOWHERE</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;fitting&quot;</span><span class="p">:</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">CallAfter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SelectAllType</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">CallAfter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">treeSelectionUpdate</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onDoubleClick">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onDoubleClick">[docs]</a>
    <span class="k">def</span> <span class="nf">onDoubleClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Select-all type on item double click.&quot;&quot;&quot;</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetItem</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;fitting&quot;</span><span class="p">:</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">CallAfter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SelectAllType</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">CallAfter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">treeSelectionUpdate</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onKey">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onKey">[docs]</a>
    <span class="k">def</span> <span class="nf">onKey</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Catch key events in the panel.&quot;&quot;&quot;</span>
        <span class="c1"># See if the tree is in focus. If not, pass the event on</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetKeyCode</span><span class="p">()</span>

        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="n">node</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">selections</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Shift+Ctrl+A</span>
        <span class="c1"># &quot;fitting&quot; mode    --  Select all nodes of a given type</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">ShiftDown</span><span class="p">()</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">ControlDown</span><span class="p">()</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">65</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;fitting&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SelectAllType</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">treeSelectionUpdate</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="c1"># Ctrl+A</span>
        <span class="c1"># &quot;fitting&quot; mode    --  Select all nodes</span>
        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">ControlDown</span><span class="p">()</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">65</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;fitting&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SelectAll</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">treeSelectionUpdate</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="c1"># XXX - removed - Without undo functionality, this is too dangerous.</span>
        <span class="c1"># Delete</span>
        <span class="c1"># &quot;fitting&quot; mode    --  Delete selected noded</span>
        <span class="c1"># elif key == 127:</span>
        <span class="c1">#    if self.mode == &quot;fitting&quot;:</span>
        <span class="c1">#        self.onDelete(None)</span>

        <span class="c1"># Tab</span>
        <span class="c1"># Move to the right panel</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">SetFocus</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>

        <span class="k">return</span></div>


    <span class="c1"># MENU RELATED FUNCTIONS ##################################################</span>

<div class="viewcode-block" id="MainFrame.updateToolbar">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.updateToolbar">[docs]</a>
    <span class="k">def</span> <span class="nf">updateToolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the toolbar based upon the status of the program.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">EnableTool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveId</span><span class="p">,</span> <span class="p">(</span><span class="n">pdfguiglobals</span><span class="o">.</span><span class="n">isAltered</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">runningDict</span> <span class="o">==</span> <span class="p">{}))</span>

        <span class="n">itemtype</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">selections</span><span class="p">:</span>
            <span class="n">itemtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># This is redundant, but easy to maintain</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;fitting&quot;</span><span class="p">:</span>

            <span class="c1"># Quickplot</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selections</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">itemtype</span> <span class="ow">and</span> <span class="n">itemtype</span> <span class="o">!=</span> <span class="s2">&quot;fit&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">EnableTool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quickPlotId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">EnableTool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quickPlotId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

            <span class="c1"># Fit run/stop</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">runningDict</span><span class="p">:</span>
                <span class="c1"># No fit is running</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">EnableTool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stopFitId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="c1"># We can run a fit if there are any selections</span>
                <span class="k">if</span> <span class="n">selections</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">EnableTool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runFitId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">EnableTool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runFitId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">EnableTool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stopFitId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">EnableTool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runFitId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Quickplot</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">EnableTool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quickPlotId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

            <span class="c1"># Fit run/stop</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">EnableTool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stopFitId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolBar</span><span class="o">.</span><span class="n">EnableTool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runFitId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.needsSave">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.needsSave">[docs]</a>
    <span class="k">def</span> <span class="nf">needsSave</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">altered</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Tell the gui that the program needs to be saved.</span>

<span class="sd">        This changes the state of the save menu and tool bar items.</span>

<span class="sd">        altered     --  Whether or not the program needs saving (default True).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">quitting</span><span class="p">:</span>
            <span class="n">pdfguiglobals</span><span class="o">.</span><span class="n">isAltered</span> <span class="o">=</span> <span class="n">altered</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateToolbar</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.disableSharedMenuItems">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.disableSharedMenuItems">[docs]</a>
    <span class="k">def</span> <span class="nf">disableSharedMenuItems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">menu</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Disable some menu items based upon what is selected in the tree.</span>

<span class="sd">        menu        --  The menu which to apply the changes.</span>

<span class="sd">        Note that this method is meant to disable only the shared menu items,</span>
<span class="sd">        that is, those that use the same menu item Ids. These are defined in the</span>
<span class="sd">        top part of __defineLocalIds().  Putting this logic into a single method</span>
<span class="sd">        makes it easier to make changes with the menus. If a specific menu needs</span>
<span class="sd">        additional logic, put that in a separate method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Start by refreshing the shared items. We don&#39;t need things to become</span>
        <span class="c1"># perpetually disabled. All things are enabled by default. It is up to</span>
        <span class="c1"># the logic below to disable them.</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newFitId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newPhaseId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newDataId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newCalcId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deleteId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copyId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteLinkId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Get the selections off the tree</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="n">node</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">selections</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">noPhases</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">node</span><span class="p">:</span>
            <span class="n">phases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetPhases</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="c1"># No insert calculation if there are no phases</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">phases</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">noPhases</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># No insert calculation if there are no phases</span>
        <span class="k">if</span> <span class="n">noPhases</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newCalcId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Change the paste text and enable or disable the paste function</span>
        <span class="c1"># based upon where we are in the tree or whether or not we have</span>
        <span class="c1"># something in the clipboard</span>
        <span class="n">pastename</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">clipbranchtype</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">cdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetClipboard</span><span class="p">()</span>

        <span class="c1"># No paste if nothing in the clipboard</span>
        <span class="k">if</span> <span class="n">cdata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteLinkId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">clipbranchtype</span> <span class="o">=</span> <span class="n">cdata</span><span class="o">.</span><span class="n">type</span>
            <span class="k">if</span> <span class="n">clipbranchtype</span> <span class="o">==</span> <span class="s2">&quot;fit&quot;</span><span class="p">:</span>
                <span class="n">pastename</span> <span class="o">=</span> <span class="s2">&quot;Fit&quot;</span>
                <span class="c1"># Check to see if the linking fit is still in the tree. If it is</span>
                <span class="c1"># not, we disable pasteLink</span>
                <span class="n">fitname</span> <span class="o">=</span> <span class="n">cdata</span><span class="o">.</span><span class="n">name</span>
                <span class="n">fits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetChildren</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
                <span class="n">fitnames</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">,</span> <span class="n">fits</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">fitname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fitnames</span><span class="p">:</span>
                    <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteLinkId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="c1"># pasteLink only if there&#39;s a fit in the clipboard</span>
            <span class="k">elif</span> <span class="n">clipbranchtype</span> <span class="o">==</span> <span class="s2">&quot;phase&quot;</span><span class="p">:</span>
                <span class="n">pastename</span> <span class="o">=</span> <span class="s2">&quot;Phase&quot;</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteLinkId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">clipbranchtype</span> <span class="o">==</span> <span class="s2">&quot;dataset&quot;</span><span class="p">:</span>
                <span class="n">pastename</span> <span class="o">=</span> <span class="s2">&quot;Data Set&quot;</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteLinkId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">clipbranchtype</span> <span class="o">==</span> <span class="s2">&quot;calculation&quot;</span><span class="p">:</span>
                <span class="n">pastename</span> <span class="o">=</span> <span class="s2">&quot;Calculation&quot;</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteLinkId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">pastetext</span> <span class="o">=</span> <span class="s2">&quot;&amp;Paste </span><span class="si">%s</span><span class="se">\t</span><span class="s2">Ctrl+V&quot;</span> <span class="o">%</span> <span class="n">pastename</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteId</span><span class="p">,</span> <span class="n">pastetext</span><span class="p">)</span>

        <span class="c1"># Disable certain entries based upon where we clicked.</span>
        <span class="c1"># No copy, paste, or insert on multiple items.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selections</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copyId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteLinkId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newDataId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newPhaseId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newCalcId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Disallow paste of fit if no items selected</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">selections</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copyId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deleteId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newDataId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newPhaseId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newCalcId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">clipbranchtype</span> <span class="o">!=</span> <span class="s2">&quot;fit&quot;</span><span class="p">:</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteLinkId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.disableMainMenuItems">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.disableMainMenuItems">[docs]</a>
    <span class="k">def</span> <span class="nf">disableMainMenuItems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Disable main menu items.&quot;&quot;&quot;</span>

        <span class="n">menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span>
        <span class="c1"># First disable the shared items</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">disableSharedMenuItems</span><span class="p">(</span><span class="n">menu</span><span class="p">)</span>

        <span class="c1"># Enable everything that can be disabled</span>
        <span class="c1"># Menus</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">EnableTop</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">EnableTop</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">EnableTop</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">EnableTop</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">EnableTop</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">EnableTop</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">EnableTop</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Menu Items</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runFitId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stopFitId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportFitPDFId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportFitStruId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportResId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runCalcId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportCalcPDFId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printBLId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printBAId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportNewStruId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotIStructId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotFStructId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aboutItem</span><span class="o">.</span><span class="n">GetId</span><span class="p">(),</span> <span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Reset the save menus so that they can be disabled if a fit is running.</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveId</span><span class="p">,</span> <span class="n">pdfguiglobals</span><span class="o">.</span><span class="n">isAltered</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveAsId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">openId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recentId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Now disable the non-shared menu items</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="n">numsel</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">selections</span><span class="p">)</span>
        <span class="n">node</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">selections</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">itemtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">itemtype</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># MODE</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;fitting&quot;</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deleteId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copyId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pasteId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runFitId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runCalcId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newFitId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newCalcId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newPhaseId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newDataId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="c1"># FIT</span>
        <span class="k">if</span> <span class="n">itemtype</span> <span class="o">!=</span> <span class="s2">&quot;fit&quot;</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runFitId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportResId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">numsel</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportResId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">cdata</span><span class="o">.</span><span class="n">res</span><span class="p">:</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportResId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="c1"># CALCULATION</span>
        <span class="k">if</span> <span class="n">itemtype</span> <span class="o">!=</span> <span class="s2">&quot;calculation&quot;</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runCalcId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportCalcPDFId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">numsel</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportCalcPDFId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">cdata</span><span class="o">.</span><span class="n">Gcalc</span><span class="p">:</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportCalcPDFId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="c1"># PHASE</span>
        <span class="k">if</span> <span class="n">itemtype</span> <span class="o">!=</span> <span class="s2">&quot;phase&quot;</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportNewStruId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportFitStruId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printBLId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printBAId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotIStructId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotFStructId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">numsel</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotIStructId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotFStructId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printBLId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printBAId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportFitStruId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportNewStruId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotIStructId</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">cdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">cdata</span><span class="o">.</span><span class="n">refined</span><span class="p">:</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportFitStruId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotFStructId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="c1"># DATASET</span>
        <span class="k">if</span> <span class="n">itemtype</span> <span class="o">!=</span> <span class="s2">&quot;dataset&quot;</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportFitPDFId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">numsel</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportFitPDFId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">cdata</span><span class="o">.</span><span class="n">Gcalc</span><span class="p">:</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exportFitPDFId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Check the run/stop status.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">runningDict</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runCalcId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runFitId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveAsId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">openId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recentId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

            <span class="c1"># Disallow certain things during a running fit</span>
            <span class="n">pnode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetFitRoot</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pnode</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">runningDict</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">EnableTop</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">EnableTop</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">EnableTop</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">EnableTop</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">EnableTop</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stopFitId</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Show/Hide fitTree</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="s2">&quot;treeCtrlMain&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">IsShown</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showFitItem</span><span class="o">.</span><span class="n">SetItemLabel</span><span class="p">(</span><span class="s2">&quot;Hide Fit Tree&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showFitItem</span><span class="o">.</span><span class="n">SetItemLabel</span><span class="p">(</span><span class="s2">&quot;Show Fit Tree&quot;</span><span class="p">)</span>

        <span class="c1"># Show/Hide plotPanel</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="s2">&quot;plotPanel&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">IsShown</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showPlotItem</span><span class="o">.</span><span class="n">SetItemLabel</span><span class="p">(</span><span class="s2">&quot;Hide Plot Control&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showPlotItem</span><span class="o">.</span><span class="n">SetItemLabel</span><span class="p">(</span><span class="s2">&quot;Show Plot Control&quot;</span><span class="p">)</span>

        <span class="c1"># Show/Hide outputPanel</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="s2">&quot;outputPanel&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">IsShown</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showOutputItem</span><span class="o">.</span><span class="n">SetItemLabel</span><span class="p">(</span><span class="s2">&quot;Hide Output&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showOutputItem</span><span class="o">.</span><span class="n">SetItemLabel</span><span class="p">(</span><span class="s2">&quot;Show Output&quot;</span><span class="p">)</span>

        <span class="c1"># Show/Hide journalPanel</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="s2">&quot;journalPanel&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">IsShown</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showJournalItem</span><span class="o">.</span><span class="n">SetItemLabel</span><span class="p">(</span><span class="s2">&quot;Hide Journal</span><span class="se">\t</span><span class="s2">Ctrl+j&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showJournalItem</span><span class="o">.</span><span class="n">SetItemLabel</span><span class="p">(</span><span class="s2">&quot;Show Journal</span><span class="se">\t</span><span class="s2">Ctrl+j&quot;</span><span class="p">)</span>

        <span class="k">return</span></div>


    <span class="c1"># Shared menu items</span>
    <span class="c1"># The bulk of the code for these methods is in the FitTree class.</span>
<div class="viewcode-block" id="MainFrame.onNewFit">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onNewFit">[docs]</a>
    <span class="k">def</span> <span class="nf">onNewFit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start a new fit tree.</span>

<span class="sd">        A fit is given the name &quot;Fit n&quot;, where n is the smallest</span>
<span class="sd">        positive integer such that the name is not already taken.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">newfit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">AddFit</span><span class="p">()</span>
        <span class="c1"># Select the fit item so that the name can be edited</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">Expand</span><span class="p">(</span><span class="n">newfit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">EditLabel</span><span class="p">(</span><span class="n">newfit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SelectItem</span><span class="p">(</span><span class="n">newfit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">EnsureVisible</span><span class="p">(</span><span class="n">newfit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">needsSave</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onCopy">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onCopy">[docs]</a>
    <span class="k">def</span> <span class="nf">onCopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Copy the subtree of the current selected item into the clipboard.&quot;&quot;&quot;</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selections</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">CopyBranch</span><span class="p">(</span><span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onPaste">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onPaste">[docs]</a>
    <span class="k">def</span> <span class="nf">onPaste</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Paste the subtree from the clipboard into the tree.&quot;&quot;&quot;</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="n">ep</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">selections</span><span class="p">:</span>
            <span class="n">ep</span> <span class="o">=</span> <span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">newnode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">PasteBranch</span><span class="p">(</span><span class="n">ep</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">FitTreeError</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">Expand</span><span class="p">(</span><span class="n">newnode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">EditLabel</span><span class="p">(</span><span class="n">newnode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SelectItem</span><span class="p">(</span><span class="n">newnode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">EnsureVisible</span><span class="p">(</span><span class="n">newnode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">needsSave</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onPasteLink">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onPasteLink">[docs]</a>
    <span class="k">def</span> <span class="nf">onPasteLink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Paste a copied fit and link it to the original.</span>

<span class="sd">        This should only be called on a &#39;fit&#39; node, and only if the original</span>
<span class="sd">        &#39;fit&#39; node, or at least one with the same name as the original still</span>
<span class="sd">        exists in the tree.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="n">cdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetClipboard</span><span class="p">()</span>
        <span class="n">fitname</span> <span class="o">=</span> <span class="n">cdata</span><span class="o">.</span><span class="n">name</span>
        <span class="n">fits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetChildren</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
        <span class="n">fitnames</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">,</span> <span class="n">fits</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">fitname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fitnames</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">ep</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">selections</span><span class="p">:</span>
            <span class="n">ep</span> <span class="o">=</span> <span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">newnode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">PasteBranch</span><span class="p">(</span><span class="n">ep</span><span class="p">)</span>
        <span class="c1"># Now link the fit</span>
        <span class="n">newfit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">newnode</span><span class="p">)</span>
        <span class="n">oldparnames</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">cdata</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">parname</span><span class="p">,</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">newfit</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">parname</span> <span class="ow">in</span> <span class="n">oldparnames</span><span class="p">:</span>
                <span class="n">parval</span> <span class="o">=</span> <span class="s2">&quot;=</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fitname</span><span class="p">,</span> <span class="n">parname</span><span class="p">)</span>
                <span class="n">par</span><span class="o">.</span><span class="n">setInitial</span><span class="p">(</span><span class="n">parval</span><span class="p">)</span>

        <span class="c1"># Make the node ready for editing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">Expand</span><span class="p">(</span><span class="n">newnode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">EditLabel</span><span class="p">(</span><span class="n">newnode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SelectItem</span><span class="p">(</span><span class="n">newnode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">EnsureVisible</span><span class="p">(</span><span class="n">newnode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">needsSave</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onInsData">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onInsData">[docs]</a>
    <span class="k">def</span> <span class="nf">onInsData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Insert a new dataset item.</span>

<span class="sd">        This opens up the new data set panel from adddatapanel.py. That panel</span>
<span class="sd">        is in charge of inserting a new phase. See the module for details.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selections</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="s2">&quot;addingdata&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switchRightPanel</span><span class="p">(</span><span class="s2">&quot;adddata&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">needsSave</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onInsPhase">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onInsPhase">[docs]</a>
    <span class="k">def</span> <span class="nf">onInsPhase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Insert a new phase item.</span>

<span class="sd">        This opens up the new phase panel from addphasepanel.py. That panel is</span>
<span class="sd">        in charge of inserting a new phase. See the module for details.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selections</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="s2">&quot;addingphase&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switchRightPanel</span><span class="p">(</span><span class="s2">&quot;addphase&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">needsSave</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onInsCalc">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onInsCalc">[docs]</a>
    <span class="k">def</span> <span class="nf">onInsCalc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Insert a new calculation item.</span>

<span class="sd">        A calculation is given the name &quot;Calculation n&quot;, where n is the smallest</span>
<span class="sd">        positive integer such that the name is not already taken.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selections</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">fitroot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetFitRoot</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="n">newcalc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">AddCalc</span><span class="p">(</span><span class="n">fitroot</span><span class="p">,</span> <span class="s2">&quot;Calculation 1&quot;</span><span class="p">,</span> <span class="n">insertafter</span><span class="o">=</span><span class="n">node</span><span class="p">)</span>
            <span class="c1"># Select the calculation item so that the name can be edited</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">UnselectAll</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">EditLabel</span><span class="p">(</span><span class="n">newcalc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SelectItem</span><span class="p">(</span><span class="n">newcalc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">EnsureVisible</span><span class="p">(</span><span class="n">newcalc</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">needsSave</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onDelete">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onDelete">[docs]</a>
    <span class="k">def</span> <span class="nf">onDelete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove the subtrees starting from the selected nodes.&quot;&quot;&quot;</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>

        <span class="c1"># find a node to choose after deletion</span>
        <span class="n">fitroot</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">roots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetChildren</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
        <span class="n">delroots</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetFitRoot</span><span class="p">,</span> <span class="n">selections</span><span class="p">))</span>
        <span class="c1"># Find the fit node above the first removed node.</span>
        <span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">roots</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">selections</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="n">fitroot</span> <span class="o">=</span> <span class="n">root</span>
            <span class="k">if</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">delroots</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="c1"># Delete!</span>
        <span class="k">if</span> <span class="n">selections</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">DeleteBranches</span><span class="p">(</span><span class="n">selections</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">needsSave</span><span class="p">()</span>

        <span class="c1"># Select the fit root it it exists. If not, select the first fit node.</span>
        <span class="c1"># If that does not exist, then go blank.</span>
        <span class="k">if</span> <span class="n">fitroot</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SelectItem</span><span class="p">(</span><span class="n">fitroot</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetChildren</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">fits</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SelectItem</span><span class="p">(</span><span class="n">fits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">switchRightPanel</span><span class="p">(</span><span class="s2">&quot;blank&quot;</span><span class="p">)</span>
        <span class="k">return</span></div>


    <span class="c1"># Main menu items</span>

<div class="viewcode-block" id="MainFrame.onRun">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onRun">[docs]</a>
    <span class="k">def</span> <span class="nf">onRun</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run the selected fits/calculations and disable their tree entries.</span>

<span class="sd">        This also runs calculations that are children of a running fit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Make sure that the tree is focued. This will trigger the KILL_FOCUS</span>
        <span class="c1"># events of the other panels.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SetFocus</span><span class="p">()</span>

        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="c1"># Get the calculation nodes and fit parent nodes from the selections.</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetFitRoot</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">sel</span> <span class="ow">in</span> <span class="n">selections</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;calculation&quot;</span>
        <span class="p">]</span>
        <span class="n">nodes</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">sel</span> <span class="k">for</span> <span class="n">sel</span> <span class="ow">in</span> <span class="n">selections</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;calculation&quot;</span><span class="p">])</span>

        <span class="c1"># Add calculation nodes that are children of fit nodes, and order them</span>
        <span class="c1"># as if walking down the fit tree</span>
        <span class="n">allnodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allnodes</span><span class="p">:</span>
                <span class="n">allnodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;fit&quot;</span><span class="p">:</span>
                    <span class="n">allnodes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetChildren</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>

        <span class="c1"># Disable the current panel</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">key</span> <span class="o">!=</span> <span class="s2">&quot;calculation&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Change the color of the fitting nodes depending upon their status. See</span>
        <span class="c1"># updateFittingStatus for the color scheme. Create a dictionary of fits</span>
        <span class="c1"># for ease of use.</span>
        <span class="k">for</span> <span class="n">sel</span> <span class="ow">in</span> <span class="n">allnodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;fit&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SetItemBackgroundColour</span><span class="p">(</span><span class="n">sel</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">LIGHT_GREY</span><span class="p">)</span>
                <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">runningDict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">sel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">needsSave</span><span class="p">()</span>

        <span class="n">IDlist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">,</span> <span class="n">allnodes</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">IDlist</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onStop">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onStop">[docs]</a>
    <span class="k">def</span> <span class="nf">onStop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop all fits.</span>

<span class="sd">        This removes all items from the runningDict and changes the status</span>
<span class="sd">        colors back to wxWHITE.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">needsSave</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onPreferences">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onPreferences">[docs]</a>
    <span class="k">def</span> <span class="nf">onPreferences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Switch the right panel to the &#39;preferences&#39; panel.</span>

<span class="sd">        The &#39;preferences&#39; panel uses the &#39;config&#39; mode.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="s2">&quot;config&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">switchRightPanel</span><span class="p">(</span><span class="s2">&quot;preferences&quot;</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onDefaultLayout">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onDefaultLayout">[docs]</a>
    <span class="k">def</span> <span class="nf">onDefaultLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Place the fit tree and plot panel in default locations.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.windowperspective</span> <span class="kn">import</span> <span class="n">default</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">LoadPerspective</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onShowFit">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onShowFit">[docs]</a>
    <span class="k">def</span> <span class="nf">onShowFit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Make sure the fit tree is visible.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="s2">&quot;treeCtrlMain&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">IsShown</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="s2">&quot;treeCtrlMain&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Hide</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="s2">&quot;treeCtrlMain&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onShowPlot">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onShowPlot">[docs]</a>
    <span class="k">def</span> <span class="nf">onShowPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Make sure the plot panel is visible.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="s2">&quot;plotPanel&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">IsShown</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="s2">&quot;plotPanel&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Hide</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="s2">&quot;plotPanel&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onShowOutput">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onShowOutput">[docs]</a>
    <span class="k">def</span> <span class="nf">onShowOutput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Make sure the output panel is visible.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="s2">&quot;outputPanel&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">IsShown</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="s2">&quot;outputPanel&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Hide</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="s2">&quot;outputPanel&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onShowJournal">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onShowJournal">[docs]</a>
    <span class="k">def</span> <span class="nf">onShowJournal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Bring up or hide the journal window.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="s2">&quot;journalPanel&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">IsShown</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="s2">&quot;journalPanel&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Hide</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">GetPane</span><span class="p">(</span><span class="s2">&quot;journalPanel&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">journalPanel</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">journalPanel</span><span class="o">.</span><span class="n">SetFocus</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">Update</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onPlotIStruct">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onPlotIStruct">[docs]</a>
    <span class="k">def</span> <span class="nf">onPlotIStruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots the phase structure.</span>

<span class="sd">        Opens Atomeye and plots the structure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotStruct</span><span class="p">(</span><span class="s2">&quot;initial&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="MainFrame.onPlotFStruct">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onPlotFStruct">[docs]</a>
    <span class="k">def</span> <span class="nf">onPlotFStruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plots the phase structure.</span>

<span class="sd">        Opens Atomeye and plots the structure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plotStruct</span><span class="p">(</span><span class="s2">&quot;refined&quot;</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">_plotStruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stype</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Helper for onPlotFStruct and onPlotIStruct.&quot;&quot;&quot;</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">selections</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">itemtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">itemtype</span> <span class="o">==</span> <span class="s2">&quot;phase&quot;</span><span class="p">:</span>
                <span class="c1"># panel = self.dynamicPanels[&#39;phase&#39;]</span>
                <span class="n">cdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="n">stru</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">cdata</span><span class="p">,</span> <span class="n">stype</span><span class="p">)</span>
                <span class="n">viewer</span> <span class="o">=</span> <span class="n">structureviewer</span><span class="o">.</span><span class="n">getStructureViewer</span><span class="p">()</span>
                <span class="n">viewer</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stru</span><span class="p">)</span>
        <span class="k">return</span>

<div class="viewcode-block" id="MainFrame.onPrintBL">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onPrintBL">[docs]</a>
    <span class="k">def</span> <span class="nf">onPrintBL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print the bond lengths of a selected structure to the output panel.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.bondlengthdialog</span> <span class="kn">import</span> <span class="n">BondLengthDialog</span>

        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">selections</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">itemtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">itemtype</span> <span class="o">==</span> <span class="s2">&quot;phase&quot;</span><span class="p">:</span>
                <span class="c1"># panel = self.dynamicPanels[&#39;phase&#39;]</span>
                <span class="n">cdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="n">S</span> <span class="o">=</span> <span class="n">cdata</span><span class="o">.</span><span class="n">refined</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">S</span><span class="p">:</span>
                    <span class="n">S</span> <span class="o">=</span> <span class="n">cdata</span><span class="o">.</span><span class="n">initial</span>

                <span class="n">dlg</span> <span class="o">=</span> <span class="n">BondLengthDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">setStructure</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
                    <span class="n">fitroot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetFitRoot</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                    <span class="n">fitting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">fitroot</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">redirectStdout</span><span class="p">()</span>

                    <span class="c1"># Figure out what to calculate. If the upper and lower bound</span>
                    <span class="c1"># is too small, it is assumed that a single distance is</span>
                    <span class="c1"># intended to be calculated.</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">a</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">b</span>
                    <span class="n">ea</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ea</span>
                    <span class="n">eb</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">eb</span>
                    <span class="n">lb</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">dlg</span><span class="o">.</span><span class="n">lb</span><span class="p">,</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ub</span><span class="p">)</span>
                    <span class="n">ub</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">dlg</span><span class="o">.</span><span class="n">lb</span><span class="p">,</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ub</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">lb</span> <span class="o">==</span> <span class="n">ub</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">fitting</span><span class="o">.</span><span class="n">outputBondLengthAtoms</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fitting</span><span class="o">.</span><span class="n">outputBondLengthTypes</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">ea</span><span class="p">,</span> <span class="n">eb</span><span class="p">,</span> <span class="n">lb</span><span class="p">,</span> <span class="n">ub</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">updateOutput</span><span class="p">()</span>
                    <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onPrintBA">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onPrintBA">[docs]</a>
    <span class="k">def</span> <span class="nf">onPrintBA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print the bond angles of a selected structure to the output panel.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">diffpy.pdfgui.gui.bondangledialog</span> <span class="kn">import</span> <span class="n">BondAngleDialog</span>

        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">selections</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">itemtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">itemtype</span> <span class="o">==</span> <span class="s2">&quot;phase&quot;</span><span class="p">:</span>
                <span class="c1"># panel = self.dynamicPanels[&#39;phase&#39;]</span>
                <span class="n">cdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="n">S</span> <span class="o">=</span> <span class="n">cdata</span><span class="o">.</span><span class="n">refined</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">S</span><span class="p">:</span>
                    <span class="n">S</span> <span class="o">=</span> <span class="n">cdata</span><span class="o">.</span><span class="n">initial</span>

                <span class="n">dlg</span> <span class="o">=</span> <span class="n">BondAngleDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">setStructure</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
                    <span class="n">fitroot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetFitRoot</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                    <span class="n">fitting</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">fitroot</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">redirectStdout</span><span class="p">()</span>
                    <span class="n">fitting</span><span class="o">.</span><span class="n">outputBondAngle</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">dlg</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">dlg</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="n">dlg</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">updateOutput</span><span class="p">()</span>
                    <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span></div>


<div class="viewcode-block" id="MainFrame.onQuickPlot">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onQuickPlot">[docs]</a>
    <span class="k">def</span> <span class="nf">onQuickPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Quickly plot information for the selected node.&quot;&quot;&quot;</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selections</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">refs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">node</span><span class="p">)]</span>
        <span class="n">nodetype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">nodetype</span> <span class="o">==</span> <span class="s2">&quot;dataset&quot;</span><span class="p">:</span>
            <span class="n">xval</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span>
            <span class="c1"># For quick plotting, keep this order. Gdiff must be the last.</span>
            <span class="n">yvals</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Gtrunc&quot;</span><span class="p">,</span> <span class="s2">&quot;Gcalc&quot;</span><span class="p">,</span> <span class="s2">&quot;Gdiff&quot;</span><span class="p">]</span>
            <span class="n">soffset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span><span class="o">.</span><span class="n">offsetTextCtrl</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">soffset</span><span class="p">:</span>
                <span class="n">offset</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span><span class="o">.</span><span class="n">offsetTextCtrl</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xval</span><span class="p">,</span> <span class="n">yvals</span><span class="p">,</span> <span class="n">refs</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="n">offset</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">nodetype</span> <span class="o">==</span> <span class="s2">&quot;calculation&quot;</span><span class="p">:</span>
            <span class="n">xval</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span>
            <span class="n">yvals</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Gcalc&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xval</span><span class="p">,</span> <span class="n">yvals</span><span class="p">,</span> <span class="n">refs</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">nodetype</span> <span class="o">==</span> <span class="s2">&quot;phase&quot;</span><span class="p">:</span>
            <span class="n">cdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cdata</span><span class="o">.</span><span class="n">refined</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">onPlotFStruct</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">onPlotIStruct</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onAbout">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onAbout">[docs]</a>
    <span class="k">def</span> <span class="nf">onAbout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">DialogAbout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1">#        dlg.CenterOnScreen()</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onRequest">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onRequest">[docs]</a>
    <span class="k">def</span> <span class="nf">onRequest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">ErrorReportDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># dlg.errorReport = True</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onCommunity">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onCommunity">[docs]</a>
    <span class="k">def</span> <span class="nf">onCommunity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Open the brower and go to the diffpy-users Google Group.&quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">webbrowser</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">USERSMAILINGLIST</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">errorinfo</span> <span class="o">=</span> <span class="s1">&#39;Failed to open &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="n">e</span>
            <span class="k">raise</span> <span class="n">ControlError</span><span class="p">(</span><span class="n">errorinfo</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onNew">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onNew">[docs]</a>
    <span class="k">def</span> <span class="nf">onNew</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new project.&quot;&quot;&quot;</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkForSave</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">retval</span> <span class="o">!=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_CANCEL</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">DeleteAllItems</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">InitializeTree</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switchRightPanel</span><span class="p">(</span><span class="s2">&quot;welcome&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotPanel</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">needsSave</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outputPanel</span><span class="o">.</span><span class="n">clearText</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">journalPanel</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateTitle</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onOpen">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onOpen">[docs]</a>
    <span class="k">def</span> <span class="nf">onOpen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Open a file dialog so an existing project can be opened.&quot;&quot;&quot;</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkForSave</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">retval</span> <span class="o">!=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_CANCEL</span><span class="p">:</span>
            <span class="nb">dir</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">dir</span><span class="p">:</span>
                <span class="nb">dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workpath</span>
            <span class="n">matchstring</span> <span class="o">=</span> <span class="s2">&quot;PDFgui project files (*.ddp)|*.ddp;*.ddp3&quot;</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Choose a file&quot;</span><span class="p">,</span> <span class="nb">dir</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">matchstring</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
                <span class="n">fullpath</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">GetPath</span><span class="p">()</span>
                <span class="c1"># Load this file into the control center.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="n">treelist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fullpath</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">ExtendProjectTree</span><span class="p">(</span><span class="n">treelist</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="s2">&quot;fitting&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">switchRightPanel</span><span class="p">(</span><span class="s2">&quot;welcome&quot;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span> <span class="o">=</span> <span class="n">fullpath</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">workpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">fullpath</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fileHistory</span><span class="o">.</span><span class="n">AddFileToHistory</span><span class="p">(</span><span class="n">fullpath</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">needsSave</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">outputPanel</span><span class="o">.</span><span class="n">clearText</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">journalPanel</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">updateTitle</span><span class="p">()</span>
            <span class="n">d</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onSave">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onSave">[docs]</a>
    <span class="k">def</span> <span class="nf">onSave</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save the project to a predetermined location.&quot;&quot;&quot;</span>
        <span class="c1"># Make sure that the tree is focued. This will trigger the KILL_FOCUS</span>
        <span class="c1"># events of the other panels.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SetFocus</span><span class="p">()</span>

        <span class="n">code</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fileHistory</span><span class="o">.</span><span class="n">AddFileToHistory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">needsSave</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onSaveAs</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">code</span></div>


<div class="viewcode-block" id="MainFrame.onSaveAs">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onSaveAs">[docs]</a>
    <span class="k">def</span> <span class="nf">onSaveAs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Open a save dialog so the current project can be saved.&quot;&quot;&quot;</span>
        <span class="c1"># Make sure that the tree is focued. This will trigger the KILL_FOCUS</span>
        <span class="c1"># events of the other panels.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SetFocus</span><span class="p">()</span>

        <span class="n">matchstring</span> <span class="o">=</span> <span class="s2">&quot;PDFgui project files (*.ddp3)|*.ddp3|All Files|*&quot;</span>
        <span class="nb">dir</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">dir</span><span class="p">:</span>
            <span class="nb">dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workpath</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Save as...&quot;</span><span class="p">,</span>
            <span class="nb">dir</span><span class="p">,</span>
            <span class="n">filename</span> <span class="ow">or</span> <span class="s2">&quot;project.ddp3&quot;</span><span class="p">,</span>
            <span class="n">matchstring</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">FD_SAVE</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">FD_OVERWRITE_PROMPT</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">GetPath</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span> <span class="o">!=</span> <span class="s2">&quot;.ddp3&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span> <span class="o">+=</span> <span class="s2">&quot;.ddp3&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fileHistory</span><span class="o">.</span><span class="n">AddFileToHistory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>
            <span class="c1"># Save the file</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">needsSave</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateTitle</span><span class="p">()</span>
        <span class="n">d</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">code</span></div>


<div class="viewcode-block" id="MainFrame.onQuit">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onQuit">[docs]</a>
    <span class="k">def</span> <span class="nf">onQuit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Shut down gracefully.&quot;&quot;&quot;</span>
        <span class="c1"># Make sure that we have focus.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetFocus</span><span class="p">()</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkForSave</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">retval</span> <span class="o">!=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_CANCEL</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">quitting</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateConfiguration</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">writeConfiguration</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auiManager</span><span class="o">.</span><span class="n">UnInit</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onMRUFile">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onMRUFile">[docs]</a>
    <span class="k">def</span> <span class="nf">onMRUFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Open a recently used file.&quot;&quot;&quot;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetId</span><span class="p">()</span> <span class="o">-</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_FILE1</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileHistory</span><span class="o">.</span><span class="n">GetHistoryFile</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkForSave</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">retval</span> <span class="o">!=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_CANCEL</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">treelist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">ExtendProjectTree</span><span class="p">(</span><span class="n">treelist</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="s2">&quot;fitting&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">switchRightPanel</span><span class="p">(</span><span class="s2">&quot;welcome&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">needsSave</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">outputPanel</span><span class="o">.</span><span class="n">clearText</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">journalPanel</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span> <span class="o">=</span> <span class="n">filename</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">workpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fileHistory</span><span class="o">.</span><span class="n">AddFileToHistory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fullpath</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">updateTitle</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">ControlError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fileHistory</span><span class="o">.</span><span class="n">RemoveFileFromHistory</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">updateConfiguration</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">writeConfiguration</span><span class="p">()</span>
                <span class="k">raise</span> <span class="n">e</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onExportRes">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onExportRes">[docs]</a>
    <span class="k">def</span> <span class="nf">onExportRes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Export the results file for the selected calculation.&quot;&quot;&quot;</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">selections</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodetype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nodetype</span> <span class="o">!=</span> <span class="s2">&quot;fit&quot;</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">cdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="n">basename</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> <span class="n">name</span>
        <span class="n">matchstring</span> <span class="o">=</span> <span class="s2">&quot;PDFgui results files (*.res)|*.res|All Files|*&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Save as...&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workpath</span><span class="p">,</span>
            <span class="n">basename</span><span class="p">,</span>
            <span class="n">matchstring</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">FD_SAVE</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">FD_OVERWRITE_PROMPT</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">GetPath</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workpath</span><span class="p">,</span> <span class="n">savename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="c1"># Add the right extention if it doesn&#39;t already have it.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">savename</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">or</span> <span class="n">savename</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">!=</span> <span class="s2">&quot;res&quot;</span><span class="p">:</span>
                <span class="n">savename</span> <span class="o">+=</span> <span class="s2">&quot;.res&quot;</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workpath</span><span class="p">,</span> <span class="n">savename</span><span class="p">)</span>
            <span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cdata</span><span class="o">.</span><span class="n">res</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">d</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onRSeries">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onRSeries">[docs]</a>
    <span class="k">def</span> <span class="nf">onRSeries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Open up the r-series panel.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="s2">&quot;rseries&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">switchRightPanel</span><span class="p">(</span><span class="s2">&quot;rseries&quot;</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onTSeries">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onTSeries">[docs]</a>
    <span class="k">def</span> <span class="nf">onTSeries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Open up the temperature series panel.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="s2">&quot;tseries&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">switchRightPanel</span><span class="p">(</span><span class="s2">&quot;tseries&quot;</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onDSeries">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onDSeries">[docs]</a>
    <span class="k">def</span> <span class="nf">onDSeries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Open up the doping series panel.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="s2">&quot;dseries&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">switchRightPanel</span><span class="p">(</span><span class="s2">&quot;dseries&quot;</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onExportNewStruct">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onExportNewStruct">[docs]</a>
    <span class="k">def</span> <span class="nf">onExportNewStruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Export a structure that was created from scratch.&quot;&quot;&quot;</span>
        <span class="n">extlist</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;stru&quot;</span><span class="p">,</span> <span class="s2">&quot;cif&quot;</span><span class="p">,</span> <span class="s2">&quot;pdb&quot;</span><span class="p">,</span> <span class="s2">&quot;xyz&quot;</span><span class="p">,</span> <span class="s2">&quot;xyz&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
        <span class="n">fmtlist</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;pdffit&quot;</span><span class="p">,</span> <span class="s2">&quot;cif&quot;</span><span class="p">,</span> <span class="s2">&quot;pdb&quot;</span><span class="p">,</span> <span class="s2">&quot;xyz&quot;</span><span class="p">,</span> <span class="s2">&quot;rawxyz&quot;</span><span class="p">,</span> <span class="s2">&quot;xcfg&quot;</span><span class="p">]</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">selections</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodetype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nodetype</span> <span class="o">!=</span> <span class="s2">&quot;phase&quot;</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">cdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="c1"># branchname = self.treeCtrlMain.GetBranchName(node)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="n">basename</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> <span class="n">name</span>
        <span class="n">matchstring</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;PDFfit structure file (*.stru)|*.stru|&quot;</span>
            <span class="s2">&quot;Crystallographic Information File (*.cif)|*.cif|&quot;</span>
            <span class="s2">&quot;Protein Data Bank file (*.pdb)|*.pdb|&quot;</span>
            <span class="s2">&quot;Labeled coordinate file (*.xyz)|*.xyz|&quot;</span>
            <span class="s2">&quot;Raw coordinate file (*.xyz)|*.xyz|&quot;</span>
            <span class="s2">&quot;AtomEye configuration file|*&quot;</span>
        <span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Save as...&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workpath</span><span class="p">,</span>
            <span class="n">basename</span><span class="p">,</span>
            <span class="n">matchstring</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">FD_SAVE</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">FD_OVERWRITE_PROMPT</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">GetFilterIndex</span><span class="p">()</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">GetPath</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workpath</span><span class="p">,</span> <span class="n">savename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="c1"># Add the right extention if the file needs it.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">savename</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">or</span> <span class="p">(</span><span class="n">extlist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span> <span class="n">savename</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">extlist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">3</span><span class="p">:]):</span>
                <span class="n">savename</span> <span class="o">+=</span> <span class="s2">&quot;.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">extlist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workpath</span><span class="p">,</span> <span class="n">savename</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">cdata</span><span class="o">.</span><span class="n">initial</span><span class="o">.</span><span class="n">writeStr</span><span class="p">(</span><span class="n">fmtlist</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">d</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onExportStruct">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onExportStruct">[docs]</a>
    <span class="k">def</span> <span class="nf">onExportStruct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Export a fit structure.&quot;&quot;&quot;</span>
        <span class="n">extlist</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;stru&quot;</span><span class="p">,</span> <span class="s2">&quot;cif&quot;</span><span class="p">,</span> <span class="s2">&quot;pdb&quot;</span><span class="p">,</span> <span class="s2">&quot;xyz&quot;</span><span class="p">,</span> <span class="s2">&quot;xyz&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]</span>
        <span class="n">fmtlist</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;pdffit&quot;</span><span class="p">,</span> <span class="s2">&quot;cif&quot;</span><span class="p">,</span> <span class="s2">&quot;pdb&quot;</span><span class="p">,</span> <span class="s2">&quot;xyz&quot;</span><span class="p">,</span> <span class="s2">&quot;rawxyz&quot;</span><span class="p">,</span> <span class="s2">&quot;xcfg&quot;</span><span class="p">]</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">selections</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodetype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nodetype</span> <span class="o">!=</span> <span class="s2">&quot;phase&quot;</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">cdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="c1"># branchname = self.treeCtrlMain.GetBranchName(node)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="n">basename</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> <span class="n">name</span>
        <span class="n">matchstring</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;PDFfit structure file (*.stru)|*.stru|&quot;</span>
            <span class="s2">&quot;Crystallographic Information File (*.cif)|*.cif|&quot;</span>
            <span class="s2">&quot;Protein Data Bank file (*.pdb)|*.pdb|&quot;</span>
            <span class="s2">&quot;Labeled coordinate file (*.xyz)|*.xyz|&quot;</span>
            <span class="s2">&quot;Raw coordinate file (*.xyz)|*.xyz|&quot;</span>
            <span class="s2">&quot;AtomEye configuration file|*&quot;</span>
        <span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Save as...&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workpath</span><span class="p">,</span>
            <span class="n">basename</span><span class="p">,</span>
            <span class="n">matchstring</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">FD_SAVE</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">FD_OVERWRITE_PROMPT</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">GetFilterIndex</span><span class="p">()</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">GetPath</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workpath</span><span class="p">,</span> <span class="n">savename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="c1"># Add the right extention if the file needs it.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">savename</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">or</span> <span class="p">(</span><span class="n">extlist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span> <span class="n">savename</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">extlist</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">3</span><span class="p">:]):</span>
                <span class="n">savename</span> <span class="o">+=</span> <span class="s2">&quot;.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">extlist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workpath</span><span class="p">,</span> <span class="n">savename</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">cdata</span><span class="o">.</span><span class="n">refined</span><span class="o">.</span><span class="n">writeStr</span><span class="p">(</span><span class="n">fmtlist</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">d</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onExportPDF">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onExportPDF">[docs]</a>
    <span class="k">def</span> <span class="nf">onExportPDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Export a fit PDF.&quot;&quot;&quot;</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">selections</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodetype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nodetype</span> <span class="o">!=</span> <span class="s2">&quot;dataset&quot;</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">cdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="c1"># branchname = self.treeCtrlMain.GetBranchName(node)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="n">basename</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> <span class="n">name</span>
        <span class="n">matchstring</span> <span class="o">=</span> <span class="s2">&quot;PDF fit data file (*.fgr)|*.fgr|All Files|*&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Save as...&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workpath</span><span class="p">,</span>
            <span class="n">basename</span><span class="p">,</span>
            <span class="n">matchstring</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">FD_SAVE</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">FD_OVERWRITE_PROMPT</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">GetPath</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workpath</span><span class="p">,</span> <span class="n">savename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="c1"># Add the right extention if it doesn&#39;t already have it.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">savename</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">or</span> <span class="n">savename</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">!=</span> <span class="s2">&quot;fgr&quot;</span><span class="p">:</span>
                <span class="n">savename</span> <span class="o">+=</span> <span class="s2">&quot;.fgr&quot;</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workpath</span><span class="p">,</span> <span class="n">savename</span><span class="p">)</span>
            <span class="n">cdata</span><span class="o">.</span><span class="n">writeCalc</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">d</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onSaveCalc">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onSaveCalc">[docs]</a>
    <span class="k">def</span> <span class="nf">onSaveCalc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Export a calculated PDF.&quot;&quot;&quot;</span>
        <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">selections</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodetype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetNodeType</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nodetype</span> <span class="o">!=</span> <span class="s2">&quot;calculation&quot;</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">cdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetControlData</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="n">basename</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> <span class="n">name</span>
        <span class="n">matchstring</span> <span class="o">=</span> <span class="s2">&quot;PDF calculated data file (*.cgr)|*.cgr|All Files|*&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Save as...&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workpath</span><span class="p">,</span>
            <span class="n">basename</span><span class="p">,</span>
            <span class="n">matchstring</span><span class="p">,</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">FD_SAVE</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">FD_OVERWRITE_PROMPT</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">GetPath</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workpath</span><span class="p">,</span> <span class="n">savename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="c1"># Add the right extention if it doesn&#39;t already have it.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">savename</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="ow">or</span> <span class="n">savename</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">!=</span> <span class="s2">&quot;cgr&quot;</span><span class="p">:</span>
                <span class="n">savename</span> <span class="o">+=</span> <span class="s2">&quot;.cgr&quot;</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workpath</span><span class="p">,</span> <span class="n">savename</span><span class="p">)</span>
            <span class="n">cdata</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">d</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onDocumentation">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onDocumentation">[docs]</a>
    <span class="k">def</span> <span class="nf">onDocumentation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Show information about the documentation.&quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">webbrowser</span>

        <span class="kn">from</span> <span class="nn">six.moves.urllib.request</span> <span class="kn">import</span> <span class="n">pathname2url</span>

        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;file://&quot;</span> <span class="o">+</span> <span class="n">pathname2url</span><span class="p">(</span><span class="n">docMainFile</span><span class="p">)</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">return</span></div>


    <span class="c1"># MISC INTERACTION ITEMS</span>
<div class="viewcode-block" id="MainFrame.showMessage">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.showMessage">[docs]</a>
    <span class="k">def</span> <span class="nf">showMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;PDF Control Error&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;showMessage(self, info) --&gt; tell user about an exception and so on</span>

<span class="sd">        title -- window title</span>
<span class="sd">        info -- message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">OK</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">ICON_ERROR</span><span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="k">return</span></div>


    <span class="c1"># control items</span>
<div class="viewcode-block" id="MainFrame.lock">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.lock">[docs]</a>
    <span class="k">def</span> <span class="nf">lock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">wx12</span><span class="o">.</span><span class="n">IsMainThread</span><span class="p">():</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">MutexGuiEnter</span><span class="p">()</span></div>


<div class="viewcode-block" id="MainFrame.unlock">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.unlock">[docs]</a>
    <span class="k">def</span> <span class="nf">unlock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">wx12</span><span class="o">.</span><span class="n">IsMainThread</span><span class="p">():</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">MutexGuiLeave</span><span class="p">()</span></div>


<div class="viewcode-block" id="MainFrame.postEvent">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.postEvent">[docs]</a>
    <span class="k">def</span> <span class="nf">postEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This method is called by the control.</span>

<span class="sd">        Whenever the control needs to communicate directly with the gui it can</span>
<span class="sd">        call this method. The event is processed by onCustom and then handled by</span>
<span class="sd">        the gui on its own terms.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="n">PDFCustomEvent</span><span class="p">()</span>
        <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>
        <span class="n">event</span><span class="o">.</span><span class="n">info</span> <span class="o">=</span> <span class="n">info</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">PostEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.onCustom">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.onCustom">[docs]</a>
    <span class="k">def</span> <span class="nf">onCustom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This handles the custom events sent by the control.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ERROR</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">UPDATE</span><span class="p">:</span>
            <span class="c1"># job is a fitting or a calculation</span>
            <span class="n">job</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">info</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateFittingStatus</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">OUTPUT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateOutput</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">PLOTNOW</span><span class="p">:</span>
            <span class="c1"># job is a fitting or a calculation with a new data to plot.</span>
            <span class="n">job</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">info</span>
            <span class="k">for</span> <span class="n">plot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">plots</span><span class="p">:</span>
                <span class="n">plot</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.updateFittingStatus">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.updateFittingStatus">[docs]</a>
    <span class="k">def</span> <span class="nf">updateFittingStatus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the fitting status.</span>

<span class="sd">        This will alter the local member runningDict so that the running items</span>
<span class="sd">        cannot be altered. The following status ids are defined in the fitting</span>
<span class="sd">        module. Some are given a color which gives the user an indication of the</span>
<span class="sd">        fit status. job is actually a fitting or a calculation object.</span>

<span class="sd">        Fit status</span>
<span class="sd">        INITIALIZED     --  &#39;LIGHT GRAY&#39;</span>
<span class="sd">        CONNECTED       --  &#39;GREEN&#39;</span>
<span class="sd">        CONFIGURED      --  &#39;GREEN&#39;</span>
<span class="sd">        DONE            --  &#39;WHITE&#39;</span>

<span class="sd">        JOB Status</span>
<span class="sd">        VOID</span>
<span class="sd">        QUEUED</span>
<span class="sd">        RUNNING</span>
<span class="sd">        PAUSED</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">diffpy.pdfgui.control.fitting</span> <span class="kn">import</span> <span class="n">Fitting</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">job</span><span class="p">,</span> <span class="n">Fitting</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">name</span>
            <span class="n">fitStatus</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">fitStatus</span>
            <span class="n">jobStatus</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">jobStatus</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">runningDict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">jobStatus</span> <span class="o">==</span> <span class="n">Fitting</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fitStatus</span> <span class="o">==</span> <span class="n">Fitting</span><span class="o">.</span><span class="n">INITIALIZED</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SetItemBackgroundColour</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">LIGHT_GREY</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">fitStatus</span> <span class="ow">in</span> <span class="p">(</span><span class="n">Fitting</span><span class="o">.</span><span class="n">CONNECTED</span><span class="p">,</span> <span class="n">Fitting</span><span class="o">.</span><span class="n">CONFIGURED</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SetItemBackgroundColour</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">GREEN</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">jobStatus</span> <span class="o">==</span> <span class="n">Fitting</span><span class="o">.</span><span class="n">VOID</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">SetItemBackgroundColour</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">WHITE</span><span class="p">)</span>
                <span class="n">selections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeCtrlMain</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selections</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="c1"># Enable whatever panel is currently being viewed.</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">Enable</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">node</span> <span class="o">==</span> <span class="n">selections</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">rightPanel</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">runningDict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">needsSave</span><span class="p">()</span>

        <span class="c1"># Update the menus and toolbars whenever an event is posted.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disableMainMenuItems</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateToolbar</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="MainFrame.updateOutput">
<a class="viewcode-back" href="../../../../api/diffpy.pdfgui.gui.html#diffpy.pdfgui.gui.mainframe.MainFrame.updateOutput">[docs]</a>
    <span class="k">def</span> <span class="nf">updateOutput</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update text in outputPanel with text in stdout.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputPanel</span><span class="o">.</span><span class="n">updateText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">getEngineOutput</span><span class="p">())</span>
        <span class="k">return</span></div>
</div>



<span class="c1"># end of class MainPanel</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, The Trustees of Columbia University in the City of New York.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>